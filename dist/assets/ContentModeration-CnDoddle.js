import{j as e}from"./ui-CMGlPv8M.js";import{r as a}from"./router-02yfTqxa.js";import{G,a1 as J,aK as P,J as U,I as W,a5 as q,a6 as K,a7 as j,au as X,a as D,e as S,b as Y,c as Z,B as g,d as Q,y as T,f as c,E as ee,C as se,H as te,V as k,W as A,Y as B,Z as E,$ as O,T as ae,a2 as re,ag as ne,aB as ie}from"./index-DGiQKbnC.js";import{f as _,h as I}from"./apiUtils-Cw-_rb0N.js";import{I as le}from"./image-XeenX5rY.js";import"./vendor-Dazix4UH.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=G("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),he=()=>{const[m,N]=a.useState([]),[L,f]=a.useState(!0),[x,$]=a.useState(""),[r,F]=a.useState("pending"),[t,o]=a.useState(null),[M,b]=a.useState(!1),[V,i]=a.useState(!1),[n,y]=a.useState("approve"),[w,p]=a.useState(""),[l,C]=a.useState({}),{toast:d}=J();a.useEffect(()=>{h()},[r,x]);const h=async()=>{try{f(!0);const s=await _(`/subadmin/content/reports?status=${r}&search=${x}`),u=await I(s);N(u.data.reports||[])}catch(s){console.error("Error fetching content reports:",s),d({title:"Error",description:s.message||"Error fetching content reports",variant:"destructive"}),N([])}finally{f(!1)}};P("content_reported",s=>{d({title:"New Report",description:"New content has been reported for moderation"}),r==="pending"&&h()});const z=async()=>{if(t)try{C({...l,[t._id]:!0});const s=n==="approve"?"resolve":"dismiss",u=await _(`/subadmin/content/reports/${t._id}/${s}`,{method:"POST",body:JSON.stringify({note:w})});await I(u),d({title:"Success",description:`Report ${n==="approve"?"resolved":"dismissed"} successfully`}),i(!1),p(""),o(null),h()}catch{d({title:"Error",description:"Failed to process report",variant:"destructive"})}finally{C({...l,[t._id]:!1})}},H=s=>{switch(s){case"property":return e.jsx(le,{className:"h-4 w-4"});case"review":return e.jsx(ie,{className:"h-4 w-4"});case"message":return e.jsx(ne,{className:"h-4 w-4"});case"user":return e.jsx(T,{className:"h-4 w-4"});default:return e.jsx(v,{className:"h-4 w-4"})}},R=s=>{switch(s){case"property":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"review":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"message":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";case"user":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};return L&&m.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate reported content"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Content Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate reported content"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(W,{placeholder:"Search reports...",value:x,onChange:s=>$(s.target.value),className:"pl-10"})]}),e.jsxs(q,{value:r,onValueChange:F,children:[e.jsxs(K,{children:[e.jsx(j,{value:"pending",children:"Pending"}),e.jsx(j,{value:"resolved",children:"Resolved"}),e.jsx(j,{value:"dismissed",children:"Dismissed"})]}),e.jsx(X,{value:r,className:"space-y-4 mt-6",children:m.length===0?e.jsx(D,{children:e.jsxs(S,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(v,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Reports Found"}),e.jsx("p",{className:"text-muted-foreground text-center",children:r==="pending"?"All reports have been reviewed. Great job!":`No ${r} reports to display`})]})}):m.map(s=>e.jsxs(D,{className:"border-l-4 border-l-orange-500",children:[e.jsx(Y,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"text-lg",children:"Content Report"}),e.jsx(g,{className:R(s.type),children:e.jsxs("span",{className:"flex items-center gap-1",children:[H(s.type),s.type.charAt(0).toUpperCase()+s.type.slice(1)]})})]}),e.jsxs(Q,{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"Reported by: ",s.reportedBy.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),"Reason: ",s.reason]})]}),e.jsx("p",{className:"text-sm mt-2",children:s.description})]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{o(s),b(!0)},children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"View Details"]}),r==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{o(s),y("approve"),i(!0)},disabled:l[s._id],children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Resolve"]}),e.jsxs(c,{variant:"secondary",size:"sm",onClick:()=>{o(s),y("dismiss"),i(!0)},disabled:l[s._id],children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Dismiss"]})]})]})})]},s._id))})]}),e.jsx(k,{open:M,onOpenChange:b,children:e.jsxs(A,{className:"max-w-3xl",children:[e.jsxs(B,{children:[e.jsx(E,{children:"Content Report Details"}),e.jsx(O,{children:"Detailed information about the reported content"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Report Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Type"}),e.jsx(g,{className:R(t.type),children:t.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Status"}),e.jsx(g,{children:t.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Reported By"}),e.jsx("p",{children:t.reportedBy.name}),e.jsx("p",{className:"text-xs",children:t.reportedBy.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Date"}),e.jsx("p",{children:new Date(t.createdAt).toLocaleString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reason"}),e.jsx("p",{className:"text-sm",children:t.reason})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm",children:t.description})]}),t.content&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reported Content"}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[t.content.title&&e.jsx("p",{className:"font-medium",children:t.content.title}),t.content.description&&e.jsx("p",{className:"text-sm mt-2",children:t.content.description}),t.content.text&&e.jsx("p",{className:"text-sm mt-2",children:t.content.text})]})]})]})]})}),e.jsx(k,{open:V,onOpenChange:i,children:e.jsxs(A,{children:[e.jsxs(B,{children:[e.jsx(E,{children:n==="approve"?"Resolve Report":"Dismiss Report"}),e.jsx(O,{children:n==="approve"?"Add a note about the resolution (optional)":"Add a note about why this report is being dismissed (optional)"})]}),e.jsx(ae,{placeholder:"Add a note...",value:w,onChange:s=>p(s.target.value),rows:4}),e.jsxs(re,{children:[e.jsx(c,{variant:"outline",onClick:()=>{i(!1),p("")},children:"Cancel"}),e.jsx(c,{onClick:z,disabled:l[t?._id||""],className:n==="approve"?"bg-green-600 hover:bg-green-700":"",children:n==="approve"?"Resolve":"Dismiss"})]})]})})]})};export{he as default};
