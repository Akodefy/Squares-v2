import{j as e}from"./ui-CMGlPv8M.js";import{d as B,r as i,L as k}from"./router-02yfTqxa.js";import{G as Q,a3 as G,t as h,aK as $,f as n,aV as y,I as W,r as H,s as J,v as K,w as O,x as j,a as g,e as N,O as F,aQ as X,J as Y,h as P,B as S}from"./index-DGiQKbnC.js";import{C as Z}from"./checkbox-Cs4lqKpa.js";import{f as p}from"./favoriteService-CtvItonL.js";import{a as ee}from"./propertyUtils-DZZpAHgC.js";import{u as se}from"./use-mobile-CFRG74LA.js";import{T as L}from"./trash-2-DzllJ_4S.js";import{C as te}from"./calendar-CnnZ5ZoT.js";import{S as ae}from"./share-Bb-l1092.js";import"./vendor-Dazix4UH.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=Q("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),ve=()=>{const{isConnected:le}=G(),C=B(),r=se(),[A,M]=i.useState([]),[v,E]=i.useState(null),[_,T]=i.useState(!0),[u,D]=i.useState(""),[c,R]=i.useState("all"),[l,b]=i.useState([]),o=i.useCallback(async()=>{try{const t=await p.getFavorites();M(t.data.favorites)}catch(t){console.error("Error loading favorites:",t),h({title:"Error",description:"Failed to load favorites",variant:"destructive"})}finally{T(!1)}},[]),d=i.useCallback(async()=>{try{const t=await p.getFavoriteStats();E(t.data)}catch(t){console.error("Error loading stats:",t)}},[]);$("favorite_added",i.useCallback(t=>{o(),d()},[o,d])),$("favorite_removed",i.useCallback(t=>{o(),d()},[o,d])),i.useEffect(()=>{o(),d()},[]);const V=async t=>{try{await p.removeFromFavorites(t),await o(),await d(),h({title:"Success",description:"Property removed from favorites"})}catch(s){console.error("Error removing favorite:",s),h({title:"Error",description:"Failed to remove from favorites",variant:"destructive"})}},q=t=>{b(s=>s.includes(t)?s.filter(f=>f!==t):[...s,t])},z=async()=>{try{await Promise.all(l.map(t=>p.removeFromFavorites(t))),b([]),await o(),await d(),h({title:"Success",description:`${l.length} properties removed from favorites`})}catch(t){console.error("Error removing selected favorites:",t),h({title:"Error",description:"Failed to remove selected favorites",variant:"destructive"})}},I=()=>{if(l.length<1){h({title:"Select Properties",description:"Please select at least 1 property to compare",variant:"destructive"});return}C(`/customer/compare?properties=${l.join(",")}`)},m=A.filter(t=>{const s=t.property;if(!s)return!1;const f=typeof s.address=="string"?s.address:`${s.address.street||""} ${s.address.city||""} ${s.address.state||""}`.trim(),w=typeof s.city=="string"?s.city:s.address?.city||"",a=!u||s.title.toLowerCase().includes(u.toLowerCase())||f.toLowerCase().includes(u.toLowerCase())||w.toLowerCase().includes(u.toLowerCase()),x=!c||c==="all"||c==="available"&&s.status==="available"||c==="sold"&&s.status==="sold"||c==="rented"&&s.status==="rented"||c==="recent"&&new Date(t.createdAt)>new Date(Date.now()-10080*60*1e3);return a&&x});return _?e.jsx("div",{className:"min-h-screen bg-background p-6 pt-24",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg",children:"Loading favorites..."})})})}):e.jsx("div",{className:"min-h-screen bg-background p-6 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Favorites"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your saved properties and track your preferences"})]}),l.length>0&&e.jsxs("div",{className:`flex gap-2 ${r?"flex-col":"flex-row"}`,children:[e.jsxs(n,{variant:"outline",onClick:I,disabled:l.length<1,className:"w-full sm:w-fit",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Compare (",l.length,")"]}),e.jsxs(n,{variant:"destructive",onClick:z,className:"w-full sm:w-fit",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Remove Selected (",l.length,")"]})]})]}),e.jsxs("div",{className:`flex gap-4 ${r?"flex-col":"flex-row"}`,children:[e.jsx("div",{className:"flex-1",children:e.jsx(W,{placeholder:"Search favorites...",value:u,onChange:t=>D(t.target.value),className:"w-full"})}),e.jsxs("div",{className:`flex gap-2 ${r?"flex-col":"flex-row"}`,children:[m.length>0&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>{l.length===m.length?b([]):b(m.map(t=>t.property._id))},className:"w-full sm:w-auto",children:l.length===m.length?"Deselect All":"Select All"}),e.jsxs(H,{value:c,onValueChange:R,children:[e.jsx(J,{className:`w-full ${r?"w-full":"md:w-48"}`,children:e.jsx(K,{placeholder:"Filter by status"})}),e.jsxs(O,{children:[e.jsx(j,{value:"all",children:"All Properties"}),e.jsx(j,{value:"available",children:"Available"}),e.jsx(j,{value:"sold",children:"Sold"}),e.jsx(j,{value:"rented",children:"Rented"}),e.jsx(j,{value:"recent",children:"Recently Added"})]})]})]})]}),v&&e.jsxs("div",{className:`grid gap-4 ${r?"grid-cols-1":"grid-cols-1 md:grid-cols-3"}`,children:[e.jsx(g,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(F,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:v.totalFavorites}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Favorites"})]})]})})}),e.jsx(g,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(re,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:v?.avgPrice?p.formatPrice(v.avgPrice):"₹0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Price"})]})]})})}),e.jsx(g,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(X,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:v?.availableProperties||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Still Available"})]})]})})})]}),m.length>0&&l.length===0&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-blue-600"}),e.jsxs("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Tip:"})," Select properties using the checkboxes to compare them side-by-side (unlimited selection)"]})]})}),e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsx(g,{children:e.jsxs(N,{className:"p-12 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No favorites found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:u||c&&c!=="all"?"No properties match your search criteria":"Start adding properties to your favorites to see them here"}),e.jsx(k,{to:"/customer/search",children:e.jsxs(n,{children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Search Properties"]})})]})}):m.map(t=>{const s=t.property;if(!s)return null;const f=p.getPropertyStatusBadge(s),w=s.images&&s.images.length>0?typeof s.images[0]=="string"?s.images[0]:s.images[0].url:null;return e.jsx(g,{className:`hover:shadow-lg transition-all ${l.includes(s._id)?"ring-2 ring-primary bg-primary/5":""}`,children:e.jsx(N,{className:"p-0",children:e.jsxs("div",{className:`flex ${r?"flex-col":"flex-col md:flex-row"}`,children:[e.jsxs("div",{className:`${r?"w-full h-64":"md:w-80 h-64 md:h-48"} bg-muted flex items-center justify-center relative`,children:[w?e.jsx("img",{src:w,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center",children:e.jsx(P,{className:"w-6 h-6 text-primary"})}),e.jsx("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:e.jsx(S,{variant:f.variant,children:f.label})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(Z,{checked:l.includes(s._id),onCheckedChange:()=>q(s._id),className:"bg-white"})})]}),e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("div",{className:`flex justify-between items-start mb-4 ${r?"flex-col gap-2":"items-start"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold mb-2 ${r?"text-lg":"text-xl"}`,children:s.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:typeof s.address=="string"?s.address:`${s.address.street||""}, ${s.address.city||""}, ${s.address.state||""}`})]})]}),e.jsxs("div",{className:`text-right ${r?"text-left":""}`,children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:p.formatPrice(s.price)}),(()=>{const a=s?.area;if(!a)return null;if(typeof a=="object"&&a!==null){const x=a.builtUp||a.carpet||a.plot||1;return e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",Math.round(s.price/x),"/sq ft"]})}return typeof a=="number"?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["₹",Math.round(s.price/a),"/sq ft"]}):null})()]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-muted-foreground",children:[(()=>{const a=s?.area;if(!a)return null;if(typeof a=="object"&&a!==null){const x=a.builtUp||a.carpet||a.plot||0,U=a.unit||"sq ft";return e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[x," ",U]})})}return typeof a=="number"?e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[a," sq ft"]})}):null})(),s.bedrooms&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[s.bedrooms," bed"]})}),s.bathrooms&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[s.bathrooms," bath"]})})]}),s.amenities&&s.amenities.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[s.amenities.slice(0,3).map((a,x)=>e.jsx(S,{variant:"outline",className:"text-xs",children:a},x)),s.amenities.length>3&&e.jsxs(S,{variant:"outline",className:"text-xs",children:["+",s.amenities.length-3," more"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsxs("span",{children:["Added ",new Date(t.createdAt).toLocaleDateString()]})]}),s.owner&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{children:ee(s)})})]}),e.jsxs("div",{className:`flex justify-between items-center ${r?"flex-col gap-3":""}`,children:[e.jsxs("div",{className:`flex gap-2 ${r?"flex-wrap":""}`,children:[e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{const a=`${window.location.origin}/property/${s._id}`;navigator.share?navigator.share({title:s.title,text:`Check out this property: ${s.title}`,url:a}):(navigator.clipboard.writeText(a),h({title:"Link copied",description:"Property link has been copied to clipboard"}))},className:"flex-1 sm:flex-none",children:[e.jsx(ae,{className:"w-4 h-4"}),!r&&e.jsx("span",{className:"ml-1",children:"Share"})]}),e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{const a=[s._id];C(`/customer/compare?properties=${a.join(",")}`)},className:"flex-1 sm:flex-none",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),"Compare"]}),e.jsx(k,{to:`/property/${s._id}`,className:"flex-1 sm:flex-none",children:e.jsx(n,{size:"sm",variant:"outline",className:"w-full",children:"View Details"})})]}),e.jsxs(n,{size:"sm",variant:"destructive",onClick:()=>V(s._id),className:`w-full sm:w-auto ${r?"mt-2":""}`,children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]})]})})},t._id)})})]})})};export{ve as default};
