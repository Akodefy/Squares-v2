import{j as e}from"./ui-CMGlPv8M.js";import{d as k,r as n}from"./router-02yfTqxa.js";import{Q as A,f as w,a0 as F,a as B,b as L,c as T,d as M,e as D,B as d}from"./index-DGiQKbnC.js";import{u as E}from"./usePagination-Cl5LsxIu.js";import{P as I,a as _,b as m,c as V,d as H,e as O}from"./pagination-YbYwwe1g.js";import{p as h}from"./planService-C13vtD_R.js";import{D as Q}from"./DataTable-BoD-n14Z.js";import{S as R}from"./SearchFilter-DHKHpHz_.js";import"./vendor-Dazix4UH.js";import"./ellipsis-v9J3hQEd.js";import"./table-B9xM5EYE.js";import"./square-pen-kV27aqSR.js";const se=()=>{const u=k(),[i,p]=n.useState(""),[r,g]=n.useState("all"),[x,f]=n.useState([]),[j,P]=n.useState(!0);n.useEffect(()=>{(async()=>{try{const a=await h.getPlans({limit:1e3});a.success&&f(a.data.plans)}catch(a){console.error("Failed to fetch plans:",a)}finally{P(!1)}})()},[]);const l=n.useMemo(()=>x.filter(s=>{const a=s.name.toLowerCase().includes(i.toLowerCase()),t=r==="all"||s.billingPeriod===r;return a&&t}),[x,i,r]),{paginatedItems:v,currentPage:c,totalPages:o,goToPage:y,nextPage:b,previousPage:N}=E(l,10),C=[{key:"name",label:"Plan Name",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.description.substring(0,50),"..."]})]})},{key:"price",label:"Price",render:s=>e.jsx("span",{className:"font-semibold",children:h.formatPrice(s)})},{key:"features",label:"Features",render:s=>{const a=Array.isArray(s.features)?s.features.map(t=>typeof t=="string"?t:t.name):[];return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.slice(0,2).map((t,S)=>e.jsx(d,{variant:"secondary",className:"text-xs",children:t},S)),a.length>2&&e.jsxs(d,{variant:"secondary",className:"text-xs",children:["+",a.length-2]})]})}},{key:"subscriberCount",label:"Subscribers",render:s=>e.jsx("span",{className:"font-medium",children:s.subscriberCount||0})},{key:"isActive",label:"Status",render:s=>e.jsx(d,{variant:h.getPlanBadgeVariant(s),children:s.isActive?"Active":"Inactive"})}];return j?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(A,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading plans..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Plan Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage subscription plans and pricing"})]}),e.jsxs(w,{onClick:()=>u("/admin/plans/create"),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create Plan"]})]}),e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(T,{children:"All Plans"}),e.jsxs(M,{children:[l.length," plan",l.length!==1?"s":""," found"]})]}),e.jsxs(D,{children:[e.jsx(R,{searchTerm:i,onSearchChange:p,filterValue:r,onFilterChange:g,filterOptions:[{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"}],filterPlaceholder:"Filter by billing"}),e.jsx(Q,{columns:C,data:v.map(s=>({...s,id:s._id})),editPath:s=>`/admin/plans/edit/${s._id}`}),o>1&&e.jsx("div",{className:"mt-6",children:e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(m,{children:e.jsx(V,{onClick:N,className:c===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:o},(s,a)=>a+1).map(s=>e.jsx(m,{children:e.jsx(H,{onClick:()=>y(s),isActive:c===s,className:"cursor-pointer",children:s})},s)),e.jsx(m,{children:e.jsx(O,{onClick:b,className:c===o?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})]})]})};export{se as default};
