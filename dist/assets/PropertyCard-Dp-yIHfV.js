import{j as e}from"./ui-DHQhougw.js";import{r as s,d as a}from"./router-Bi51YGN-.js";import{aF as r,S as i,m as l,n as t,o as n,p as c,f as o,u as d,ay as x,a as m,aD as h,B as p,D as j,e as u,j as v,aw as g,ax as f,aG as y,ag as b,P as N}from"./index-Bu7cQZk6.js";import{a as w}from"./propertyUtils-41DuwCMc.js";import{P,a as C}from"./PropertyContactDialog-Bn9zPQ1n.js";import{E as k}from"./EnterprisePropertyContactDialog-DXP7aY2J.js";import{vendorService as T}from"./vendorService-D-qa1QbJ.js";import{S as _}from"./square-BOVQIyt_.js";const F=({onFilterChange:a,initialFilters:d})=>{const[x,m]=s.useState({propertyType:void 0,bedrooms:void 0,minPrice:void 0,maxPrice:void 0,listingType:void 0});s.useEffect(()=>{d&&m(d)},[d]);const h=(e,s)=>{const r={...x,[e]:"all"===s||"any"===s||"any-budget"===s?void 0:s};m(r),a(r)};return e.jsx("div",{className:"bg-card border border-border rounded-xl p-4 shadow-[var(--shadow-soft)]",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(r,{className:"h-5 w-5"}),e.jsx("span",{children:"Filters:"})]}),e.jsxs(i,{value:x.listingType||"all",onValueChange:e=>h("listingType",e),children:[e.jsx(l,{className:"w-[150px]",children:e.jsx(t,{placeholder:"Listing Type"})}),e.jsxs(n,{children:[e.jsx(c,{value:"all",children:"All Types"}),e.jsx(c,{value:"sale",children:"For Sale"}),e.jsx(c,{value:"rent",children:"For Rent"}),e.jsx(c,{value:"lease",children:"For Lease"})]})]}),e.jsxs(i,{value:x.propertyType||"all",onValueChange:e=>h("propertyType",e),children:[e.jsx(l,{className:"w-[180px]",children:e.jsx(t,{placeholder:"Property Type"})}),e.jsxs(n,{children:[e.jsx(c,{value:"all",children:"All Properties"}),e.jsx(c,{value:"apartment",children:"Apartment"}),e.jsx(c,{value:"villa",children:"Villa"}),e.jsx(c,{value:"house",children:"House"}),e.jsx(c,{value:"plot",children:"Plot"}),e.jsx(c,{value:"land",children:"Land"}),e.jsx(c,{value:"commercial",children:"Commercial"}),e.jsx(c,{value:"office",children:"Office"}),e.jsx(c,{value:"pg",children:"PG (Paying Guest)"})]})]}),e.jsxs(i,{value:x.bedrooms?.toString()||"any",onValueChange:e=>{const s="any"===e?void 0:parseInt(e);h("bedrooms",s&&!isNaN(s)?s:void 0)},children:[e.jsx(l,{className:"w-[150px]",children:e.jsx(t,{placeholder:"BHK"})}),e.jsxs(n,{children:[e.jsx(c,{value:"any",children:"Any BHK"}),e.jsx(c,{value:"1",children:"1 BHK"}),e.jsx(c,{value:"2",children:"2 BHK"}),e.jsx(c,{value:"3",children:"3 BHK"}),e.jsx(c,{value:"4",children:"4+ BHK"})]})]}),e.jsxs(i,{value:2e6===x.minPrice&&4e6===x.maxPrice?"20-40":4e6===x.minPrice&&6e6===x.maxPrice?"40-60":6e6===x.minPrice&&8e6===x.maxPrice?"60-80":8e6===x.minPrice&&1e7===x.maxPrice?"80-1cr":1e7!==x.minPrice||x.maxPrice?"any-budget":"1cr+",onValueChange:e=>{let s,r;switch(e){case"20-40":s=2e6,r=4e6;break;case"40-60":s=4e6,r=6e6;break;case"60-80":s=6e6,r=8e6;break;case"80-1cr":s=8e6,r=1e7;break;case"1cr+":s=1e7,r=void 0;break;default:s=void 0,r=void 0}const i={...x,minPrice:s,maxPrice:r};m(i),a(i)},children:[e.jsx(l,{className:"w-[180px]",children:e.jsx(t,{placeholder:"Budget"})}),e.jsxs(n,{children:[e.jsx(c,{value:"any-budget",children:"Any Budget"}),e.jsx(c,{value:"20-40",children:"₹20L - ₹40L"}),e.jsx(c,{value:"40-60",children:"₹40L - ₹60L"}),e.jsx(c,{value:"60-80",children:"₹60L - ₹80L"}),e.jsx(c,{value:"80-1cr",children:"₹80L - ₹1Cr"}),e.jsx(c,{value:"1cr+",children:"₹1Cr+"})]})]}),e.jsx(o,{variant:"secondary",className:"ml-auto",onClick:()=>{const e={propertyType:void 0,bedrooms:void 0,minPrice:void 0,maxPrice:void 0,listingType:void 0};m(e),a(e)},children:"Reset Filters"})]})})},S=({property:r})=>{const i=a(),{isAuthenticated:l,user:t,isVendor:n}=d(),[c,F]=s.useState(!1),[S,B]=s.useState(!1),[L,A]=s.useState(!1),[V,H]=s.useState(!1),[$,K]=s.useState(!0),E=x.getPrimaryImage(r),D=x.formatPrice(r.price,r.listingType),O=x.formatArea(r.area),G=`${r.address.city}, ${r.address.state}`;s.useEffect(()=>{(async()=>{if(r.vendor?._id||r.owner?._id)try{K(!0);const e=r.vendor?._id||r.owner?._id,s=await T.isVendorEnterpriseProperty(e);H(s)}catch(e){H(!1)}finally{K(!1)}else K(!1)})()},[r.vendor?._id,r.owner?._id]);return e.jsxs(m,{className:"group overflow-hidden hover:shadow-[var(--shadow-large)] transition-all duration-300",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:E,alt:r.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300",onError:e=>{e.target.src=h}}),r.featured&&e.jsx(p,{className:"absolute top-3 left-3 bg-accent text-accent-foreground",children:"Featured"}),r.verified&&e.jsx(p,{className:"absolute top-3 left-3 mt-8 bg-green-500 text-white",children:"Verified"}),e.jsx(p,{className:`absolute top-3 right-12 ${"available"===r.status?"bg-green-500":"sold"===r.status?"bg-red-500":"rented"===r.status?"bg-blue-500":"bg-yellow-500"} text-white`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)}),e.jsx(o,{size:"icon",variant:"ghost",className:"absolute top-3 right-3 bg-background/80 backdrop-blur hover:bg-background",onClick:()=>{l||i("/login",{state:{from:`/property/${r._id}`,action:"favorite"}})},children:e.jsx(j,{className:"h-5 w-5"})})]}),e.jsxs(u,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:r.title}),e.jsx(p,{variant:"secondary",children:"sale"===r.listingType?"For Sale":"rent"===r.listingType?"For Rent":"For Lease"})]}),e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx(v,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm line-clamp-1",children:G})]}),e.jsx("div",{className:"text-xs text-muted-foreground mb-3 capitalize",children:r.type?r.type.replace("_"," "):"property"}),e.jsx("div",{className:"text-xs text-muted-foreground mb-3",children:w(r)}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-3",children:[r.bedrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsxs("span",{children:[r.bedrooms," BHK"]})]}),r.bathrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsxs("span",{children:[r.bathrooms," Bath"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:O})]})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:D}),r.amenities.length>0&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[r.amenities.slice(0,3).map((s,a)=>e.jsx(p,{variant:"outline",className:"text-xs",children:s},a)),r.amenities.length>3&&e.jsxs(p,{variant:"outline",className:"text-xs",children:["+",r.amenities.length-3," more"]})]})]}),e.jsxs(y,{className:"p-4 pt-0 flex gap-2",children:[!$&&!V&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"outline",className:"flex-1",onClick:()=>{l?V?A(!0):F(!0):i("/login",{state:{from:`/property/${r._id}`,action:"message"}})},children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(o,{variant:"outline",className:"flex-1",onClick:()=>{l?V?A(!0):B(!0):i("/login",{state:{from:`/property/${r._id}`,action:"contact"}})},children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Contact"]})]}),!$&&V&&e.jsxs(o,{variant:"outline",className:"flex-1 bg-green-50 hover:bg-green-100 text-green-700 border-green-200",onClick:()=>A(!0),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"WhatsApp Contact"]}),e.jsx(o,{className:"flex-1",onClick:()=>{l&&n&&(r.owner?._id===t?.id||r.vendor?._id===t?.id)?i(`/vendor/properties/details/${r._id}`):i(`/property/${r._id}`)},children:"View Details"})]}),e.jsx(P,{open:c,onOpenChange:F,property:r,onMessageSent:()=>{}}),e.jsx(C,{open:S,onOpenChange:B,property:r}),e.jsx(k,{open:L,onOpenChange:A,property:r})]})};export{F as P,S as a};
