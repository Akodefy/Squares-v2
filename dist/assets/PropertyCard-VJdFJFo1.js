import{j as e}from"./ui-CMGlPv8M.js";import{r as o,d as D}from"./router-02yfTqxa.js";import{aQ as V,r as j,s as v,v as f,w as b,x as a,f as m,u as H,aH as w,a as M,aL as I,B as d,O as K,e as R,h as $,aF as O,aG as G,aR as z,ag as S,z as q}from"./index-DGiQKbnC.js";import{a as U}from"./propertyUtils-DZZpAHgC.js";import{P as Q,a as W}from"./PropertyContactDialog-BKsT45oI.js";import{E as Y}from"./EnterprisePropertyContactDialog-HvalUWsn.js";import{vendorService as J}from"./vendorService-Ci45BOYl.js";import{S as X}from"./square-pqeblIaW.js";const ne=({onFilterChange:s})=>{const[t,n]=o.useState({propertyType:void 0,bedrooms:void 0,minPrice:void 0,maxPrice:void 0,listingType:void 0}),x=(i,l)=>{const r={...t,[i]:l==="all"||l==="any"||l==="any-budget"?void 0:l};n(r),s(r)},u=i=>{let l,r;switch(i){case"20-40":l=2e6,r=4e6;break;case"40-60":l=4e6,r=6e6;break;case"60-80":l=6e6,r=8e6;break;case"80-1cr":l=8e6,r=1e7;break;case"1cr+":l=1e7,r=void 0;break;default:l=void 0,r=void 0}const c={...t,minPrice:l,maxPrice:r};n(c),s(c)},p=()=>{const i={propertyType:void 0,bedrooms:void 0,minPrice:void 0,maxPrice:void 0,listingType:void 0};n(i),s(i)};return e.jsx("div",{className:"bg-card border border-border rounded-xl p-4 shadow-[var(--shadow-soft)]",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Filters:"})]}),e.jsxs(j,{value:t.listingType||"all",onValueChange:i=>x("listingType",i),children:[e.jsx(v,{className:"w-[150px]",children:e.jsx(f,{placeholder:"Listing Type"})}),e.jsxs(b,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"sale",children:"For Sale"}),e.jsx(a,{value:"rent",children:"For Rent"}),e.jsx(a,{value:"lease",children:"For Lease"})]})]}),e.jsxs(j,{value:t.propertyType||"all",onValueChange:i=>x("propertyType",i),children:[e.jsx(v,{className:"w-[180px]",children:e.jsx(f,{placeholder:"Property Type"})}),e.jsxs(b,{children:[e.jsx(a,{value:"all",children:"All Properties"}),e.jsx(a,{value:"apartment",children:"Apartment"}),e.jsx(a,{value:"villa",children:"Villa"}),e.jsx(a,{value:"house",children:"House"}),e.jsx(a,{value:"plot",children:"Plot"}),e.jsx(a,{value:"land",children:"Land"}),e.jsx(a,{value:"commercial",children:"Commercial"}),e.jsx(a,{value:"office",children:"Office"}),e.jsx(a,{value:"pg",children:"PG (Paying Guest)"})]})]}),e.jsxs(j,{value:t.bedrooms?.toString()||"any",onValueChange:i=>{const l=i==="any"?void 0:parseInt(i);x("bedrooms",l&&!isNaN(l)?l:void 0)},children:[e.jsx(v,{className:"w-[150px]",children:e.jsx(f,{placeholder:"BHK"})}),e.jsxs(b,{children:[e.jsx(a,{value:"any",children:"Any BHK"}),e.jsx(a,{value:"1",children:"1 BHK"}),e.jsx(a,{value:"2",children:"2 BHK"}),e.jsx(a,{value:"3",children:"3 BHK"}),e.jsx(a,{value:"4",children:"4+ BHK"})]})]}),e.jsxs(j,{value:t.minPrice===2e6&&t.maxPrice===4e6?"20-40":t.minPrice===4e6&&t.maxPrice===6e6?"40-60":t.minPrice===6e6&&t.maxPrice===8e6?"60-80":t.minPrice===8e6&&t.maxPrice===1e7?"80-1cr":t.minPrice===1e7&&!t.maxPrice?"1cr+":"any-budget",onValueChange:u,children:[e.jsx(v,{className:"w-[180px]",children:e.jsx(f,{placeholder:"Budget"})}),e.jsxs(b,{children:[e.jsx(a,{value:"any-budget",children:"Any Budget"}),e.jsx(a,{value:"20-40",children:"₹20L - ₹40L"}),e.jsx(a,{value:"40-60",children:"₹40L - ₹60L"}),e.jsx(a,{value:"60-80",children:"₹60L - ₹80L"}),e.jsx(a,{value:"80-1cr",children:"₹80L - ₹1Cr"}),e.jsx(a,{value:"1cr+",children:"₹1Cr+"})]})]}),e.jsx(m,{variant:"secondary",className:"ml-auto",onClick:p,children:"Reset Filters"})]})})},ce=({property:s})=>{const t=D(),{isAuthenticated:n}=H(),[x,u]=o.useState(!1),[p,i]=o.useState(!1),[l,r]=o.useState(!1),[c,P]=o.useState(!1),[C,N]=o.useState(!0),k=w.getPrimaryImage(s),F=w.formatPrice(s.price,s.listingType),E=w.formatArea(s.area),y=`${s.address.city}, ${s.address.state}`;o.useEffect(()=>{(async()=>{if(s.vendor?._id||s.owner?._id)try{N(!0);const h=s.vendor?._id||s.owner?._id,A=await J.isVendorEnterpriseProperty(h);P(A)}catch(h){console.error("Failed to check enterprise status:",h),P(!1)}finally{N(!1)}else N(!1)})()},[s.vendor?._id,s.owner?._id]);const T=()=>{t(`/property/${s._id}`)},B=()=>{if(!n){t("/login",{state:{from:`/property/${s._id}`,action:"message"}});return}c?r(!0):u(!0)},L=()=>{if(!n){t("/login",{state:{from:`/property/${s._id}`,action:"contact"}});return}c?r(!0):i(!0)},_=()=>{if(!n){t("/login",{state:{from:`/property/${s._id}`,action:"favorite"}});return}};return e.jsxs(M,{className:"group overflow-hidden hover:shadow-[var(--shadow-large)] transition-all duration-300",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:k,alt:s.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300",onError:g=>{g.target.src=I}}),s.featured&&e.jsx(d,{className:"absolute top-3 left-3 bg-accent text-accent-foreground",children:"Featured"}),s.verified&&e.jsx(d,{className:"absolute top-3 left-3 mt-8 bg-green-500 text-white",children:"Verified"}),e.jsx(d,{className:`absolute top-3 right-12 ${s.status==="available"?"bg-green-500":s.status==="sold"?"bg-red-500":s.status==="rented"?"bg-blue-500":"bg-yellow-500"} text-white`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsx(m,{size:"icon",variant:"ghost",className:"absolute top-3 right-3 bg-background/80 backdrop-blur hover:bg-background",onClick:_,children:e.jsx(K,{className:"h-5 w-5"})})]}),e.jsxs(R,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:s.title}),e.jsx(d,{variant:"secondary",children:s.listingType==="sale"?"For Sale":s.listingType==="rent"?"For Rent":"For Lease"})]}),e.jsxs("div",{className:"flex items-center text-muted-foreground mb-2",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm line-clamp-1",children:y})]}),e.jsx("div",{className:"text-xs text-muted-foreground mb-3 capitalize",children:s.type?s.type.replace("_"," "):"property"}),e.jsx("div",{className:"text-xs text-muted-foreground mb-3",children:U(s)}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-3",children:[s.bedrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.bedrooms," BHK"]})]}),s.bathrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.bathrooms," Bath"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:E})]})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:F}),s.amenities.length>0&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[s.amenities.slice(0,3).map((g,h)=>e.jsx(d,{variant:"outline",className:"text-xs",children:g},h)),s.amenities.length>3&&e.jsxs(d,{variant:"outline",className:"text-xs",children:["+",s.amenities.length-3," more"]})]})]}),e.jsxs(z,{className:"p-4 pt-0 flex gap-2",children:[!C&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs(m,{variant:"outline",className:"flex-1",onClick:B,children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(m,{variant:"outline",className:"flex-1",onClick:L,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Contact"]})]}),!C&&c&&e.jsxs(m,{variant:"outline",className:"flex-1 bg-green-50 hover:bg-green-100 text-green-700 border-green-200",onClick:()=>r(!0),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"WhatsApp Contact"]}),e.jsx(m,{className:"flex-1",onClick:T,children:"View Details"})]}),e.jsx(Q,{open:x,onOpenChange:u,property:s,onMessageSent:()=>{console.log("Message sent for property:",s._id)}}),e.jsx(W,{open:p,onOpenChange:i,property:s}),e.jsx(Y,{open:l,onOpenChange:r,property:s})]})};export{ne as P,ce as a};
