import{j as e}from"./ui-CMGlPv8M.js";import{r}from"./router-02yfTqxa.js";import{a1 as $,aK as B,J as L,I as O,a as y,e as b,b as V,c as _,d as F,h as I,y as z,B as w,f as l,E as U,V as H,W,Y as Z,Z as J,$ as K,a2 as M}from"./index-DGiQKbnC.js";import{f as R,h as C}from"./apiUtils-Cw-_rb0N.js";import{C as j}from"./circle-alert-YlyZ8R6H.js";import{C as Y}from"./calendar-CnnZ5ZoT.js";import{R as P}from"./rotate-ccw-DWadLLbg.js";import"./vendor-Dazix4UH.js";const ae=()=>{const[n,p]=r.useState([]),[k,g]=r.useState(!0),[o,D]=r.useState(""),[i,u]=r.useState(1),[m,S]=r.useState(1),[t,A]=r.useState(null),[T,c]=r.useState(!1),[x,f]=r.useState({}),{toast:d}=$();r.useEffect(()=>{h()},[i,o]);const h=async()=>{try{g(!0);const s=await R(`/subadmin/properties/rejected?page=${i}&search=${o}`),a=await C(s);p(a.data.properties||[]),S(a.data.totalPages||1)}catch(s){console.error("Error fetching rejected properties:",s),d({title:"Error",description:s.message||"Error fetching rejected properties",variant:"destructive"}),p([])}finally{g(!1)}};B("property_rejected",s=>{d({title:"Property Rejected",description:"A property has been rejected"}),h()});const N=async s=>{try{f({...x,[s]:!0});const a=await R(`/subadmin/properties/${s}/reactivate`,{method:"POST"});await C(a),d({title:"Success",description:"Property reactivated and moved to pending review"}),h()}catch{d({title:"Error",description:"Failed to reactivate property",variant:"destructive"})}finally{f({...x,[s]:!1})}},v=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s),E=s=>s.builtUp?`${s.builtUp} ${s.unit}`:s.plot?`${s.plot} ${s.unit}`:s.carpet?`${s.carpet} ${s.unit}`:"N/A";return k&&n.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Rejections"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage rejected property listings"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Property Rejections"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage rejected property listings"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search rejected properties by title or city...",value:o,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsx(y,{children:e.jsxs(b,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(j,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Rejected Properties"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"There are no rejected properties at the moment"})]})}):n.map(s=>e.jsxs(y,{className:"border-l-4 border-l-red-500",children:[e.jsx(V,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(_,{className:"text-xl",children:s.title}),e.jsx(F,{className:"space-y-1",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"h-3 w-3"}),s.address.city,", ",s.address.state]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-3 w-3"}),"Rejected: ",s.rejectedAt?new Date(s.rejectedAt).toLocaleDateString():"N/A"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),s.owner.email]})]})}),s.rejectionReason&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-3 mt-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:s.rejectionReason}),s.rejectedBy&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:["Rejected by: ",s.rejectedBy.name]})]})]})})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:v(s.price)}),e.jsx(w,{variant:"destructive",className:"mt-1",children:"Rejected"}),e.jsxs(w,{variant:"outline",className:"mt-1 ml-1",children:[s.type," â€¢ ",s.listingType]})]})]})}),e.jsx(b,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{A(s),c(!0)},children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(l,{size:"sm",variant:"secondary",onClick:()=>N(s._id),disabled:x[s._id],children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Reactivate for Review"]})]})})]},s._id))}),m>1&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(l,{variant:"outline",disabled:i===1,onClick:()=>u(i-1),children:"Previous"}),e.jsxs("span",{className:"px-3 py-2 text-sm",children:["Page ",i," of ",m]}),e.jsx(l,{variant:"outline",disabled:i===m,onClick:()=>u(i+1),children:"Next"})]}),e.jsx(H,{open:T,onOpenChange:c,children:e.jsxs(W,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsx(J,{children:t?.title}),e.jsx(K,{children:"Rejected property details and information"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[t.rejectionReason&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-900 dark:text-red-100",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:t.rejectionReason}),t.rejectedBy&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2",children:["Rejected by: ",t.rejectedBy.name," (",t.rejectedBy.email,")"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Property Details"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Type:"})," ",t.type]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Listing Type:"})," ",t.listingType]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Price:"})," ",v(t.price)]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Area:"})," ",E(t.area)]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bedrooms:"})," ",t.bedrooms]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bathrooms:"})," ",t.bathrooms]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Location & Contact"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Address:"})," ",t.address.street]}),e.jsxs("li",{children:[e.jsx("strong",{children:"City:"})," ",t.address.city]}),e.jsxs("li",{children:[e.jsx("strong",{children:"State:"})," ",t.address.state]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Zip Code:"})," ",t.address.zipCode]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Owner:"})," ",t.owner.name]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",t.owner.email]})]})]})]}),t.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Description"}),e.jsx("p",{className:"text-sm",children:t.description})]}),t.images&&t.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:t.images.map((s,a)=>e.jsx("img",{src:s,alt:`Property ${a+1}`,className:"w-full h-32 object-cover rounded"},a))})]})]}),e.jsxs(M,{children:[e.jsx(l,{variant:"outline",onClick:()=>c(!1),children:"Close"}),t&&e.jsxs(l,{variant:"secondary",onClick:()=>{N(t._id),c(!1)},children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Reactivate for Review"]})]})]})})]})};export{ae as default};
