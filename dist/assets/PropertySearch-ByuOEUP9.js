import{b as be,j as e,c as Ne,a as we,e as F,P as L,u as K,G as ye,a0 as Pe}from"./ui-CMGlPv8M.js";import{r as l,d as Ce,h as Re}from"./router-02yfTqxa.js";import{aN as ne,aM as Ee,g as Te,a1 as ke,aH as De,a as $,e as U,J as _e,I as Be,r as G,s as Y,v as q,w as W,x as y,f as A,Q as Me,aJ as se,O as Ae,B as re,h as Fe,aF as Ke,aG as Ve}from"./index-DGiQKbnC.js";import{C as He}from"./checkbox-Cs4lqKpa.js";import{f as Q}from"./favoriteService-CtvItonL.js";import{S as Ie}from"./square-pqeblIaW.js";import"./vendor-Dazix4UH.js";var ae=["PageUp","PageDown"],oe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ie={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},V="Slider",[X,Le,ze]=we(V),[le]=Ne(V,[ze]),[Oe,z]=le(V),ce=l.forwardRef((s,r)=>{const{name:n,min:a=0,max:c=100,step:m=1,orientation:i="horizontal",disabled:d=!1,minStepsBetweenThumbs:p=0,defaultValue:N=[a],value:v,onValueChange:o=()=>{},onValueCommit:h=()=>{},inverted:j=!1,form:C,...x}=s,S=l.useRef(new Set),f=l.useRef(0),b=i==="horizontal"?$e:Ue,[g=[],E]=be({prop:v,defaultProp:N,onChange:P=>{[...S.current][f.current]?.focus(),o(P)}}),H=l.useRef(g);function _(P){const T=Qe(g,P);k(P,T)}function I(P){k(P,f.current)}function O(){const P=H.current[f.current];g[f.current]!==P&&h(g)}function k(P,T,{commit:B}={commit:!1}){const M=et(m),t=tt(Math.round((P-a)/m)*m+a,M),u=ne(t,[a,c]);E((w=[])=>{const D=qe(w,u,T);if(Ze(D,p*m)){f.current=D.indexOf(u);const te=String(D)!==String(w);return te&&B&&h(D),te?D:w}else return w})}return e.jsx(Oe,{scope:s.__scopeSlider,name:n,disabled:d,min:a,max:c,valueIndexToChangeRef:f,thumbs:S.current,values:g,orientation:i,form:C,children:e.jsx(X.Provider,{scope:s.__scopeSlider,children:e.jsx(X.Slot,{scope:s.__scopeSlider,children:e.jsx(b,{"aria-disabled":d,"data-disabled":d?"":void 0,...x,ref:r,onPointerDown:F(x.onPointerDown,()=>{d||(H.current=g)}),min:a,max:c,inverted:j,onSlideStart:d?void 0:_,onSlideMove:d?void 0:I,onSlideEnd:d?void 0:O,onHomeKeyDown:()=>!d&&k(a,0,{commit:!0}),onEndKeyDown:()=>!d&&k(c,g.length-1,{commit:!0}),onStepKeyDown:({event:P,direction:T})=>{if(!d){const t=ae.includes(P.key)||P.shiftKey&&oe.includes(P.key)?10:1,u=f.current,w=g[u],D=m*t*T;k(w+D,u,{commit:!0})}}})})})})});ce.displayName=V;var[de,me]=le(V,{startEdge:"left",endEdge:"right",size:"width",direction:1}),$e=l.forwardRef((s,r)=>{const{min:n,max:a,dir:c,inverted:m,onSlideStart:i,onSlideMove:d,onSlideEnd:p,onStepKeyDown:N,...v}=s,[o,h]=l.useState(null),j=K(r,b=>h(b)),C=l.useRef(void 0),x=ye(c),S=x==="ltr",f=S&&!m||!S&&m;function R(b){const g=C.current||o.getBoundingClientRect(),E=[0,g.width],_=ee(E,f?[n,a]:[a,n]);return C.current=g,_(b-g.left)}return e.jsx(de,{scope:s.__scopeSlider,startEdge:f?"left":"right",endEdge:f?"right":"left",direction:f?1:-1,size:"width",children:e.jsx(ue,{dir:x,"data-orientation":"horizontal",...v,ref:j,style:{...v.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const g=R(b.clientX);i?.(g)},onSlideMove:b=>{const g=R(b.clientX);d?.(g)},onSlideEnd:()=>{C.current=void 0,p?.()},onStepKeyDown:b=>{const E=ie[f?"from-left":"from-right"].includes(b.key);N?.({event:b,direction:E?-1:1})}})})}),Ue=l.forwardRef((s,r)=>{const{min:n,max:a,inverted:c,onSlideStart:m,onSlideMove:i,onSlideEnd:d,onStepKeyDown:p,...N}=s,v=l.useRef(null),o=K(r,v),h=l.useRef(void 0),j=!c;function C(x){const S=h.current||v.current.getBoundingClientRect(),f=[0,S.height],b=ee(f,j?[a,n]:[n,a]);return h.current=S,b(x-S.top)}return e.jsx(de,{scope:s.__scopeSlider,startEdge:j?"bottom":"top",endEdge:j?"top":"bottom",size:"height",direction:j?1:-1,children:e.jsx(ue,{"data-orientation":"vertical",...N,ref:o,style:{...N.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:x=>{const S=C(x.clientY);m?.(S)},onSlideMove:x=>{const S=C(x.clientY);i?.(S)},onSlideEnd:()=>{h.current=void 0,d?.()},onStepKeyDown:x=>{const f=ie[j?"from-bottom":"from-top"].includes(x.key);p?.({event:x,direction:f?-1:1})}})})}),ue=l.forwardRef((s,r)=>{const{__scopeSlider:n,onSlideStart:a,onSlideMove:c,onSlideEnd:m,onHomeKeyDown:i,onEndKeyDown:d,onStepKeyDown:p,...N}=s,v=z(V,n);return e.jsx(L.span,{...N,ref:r,onKeyDown:F(s.onKeyDown,o=>{o.key==="Home"?(i(o),o.preventDefault()):o.key==="End"?(d(o),o.preventDefault()):ae.concat(oe).includes(o.key)&&(p(o),o.preventDefault())}),onPointerDown:F(s.onPointerDown,o=>{const h=o.target;h.setPointerCapture(o.pointerId),o.preventDefault(),v.thumbs.has(h)?h.focus():a(o)}),onPointerMove:F(s.onPointerMove,o=>{o.target.hasPointerCapture(o.pointerId)&&c(o)}),onPointerUp:F(s.onPointerUp,o=>{const h=o.target;h.hasPointerCapture(o.pointerId)&&(h.releasePointerCapture(o.pointerId),m(o))})})}),fe="SliderTrack",xe=l.forwardRef((s,r)=>{const{__scopeSlider:n,...a}=s,c=z(fe,n);return e.jsx(L.span,{"data-disabled":c.disabled?"":void 0,"data-orientation":c.orientation,...a,ref:r})});xe.displayName=fe;var J="SliderRange",he=l.forwardRef((s,r)=>{const{__scopeSlider:n,...a}=s,c=z(J,n),m=me(J,n),i=l.useRef(null),d=K(r,i),p=c.values.length,N=c.values.map(h=>ve(h,c.min,c.max)),v=p>1?Math.min(...N):0,o=100-Math.max(...N);return e.jsx(L.span,{"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,...a,ref:d,style:{...s.style,[m.startEdge]:v+"%",[m.endEdge]:o+"%"}})});he.displayName=J;var Z="SliderThumb",pe=l.forwardRef((s,r)=>{const n=Le(s.__scopeSlider),[a,c]=l.useState(null),m=K(r,d=>c(d)),i=l.useMemo(()=>a?n().findIndex(d=>d.ref.current===a):-1,[n,a]);return e.jsx(Ge,{...s,ref:m,index:i})}),Ge=l.forwardRef((s,r)=>{const{__scopeSlider:n,index:a,name:c,...m}=s,i=z(Z,n),d=me(Z,n),[p,N]=l.useState(null),v=K(r,R=>N(R)),o=p?i.form||!!p.closest("form"):!0,h=Pe(p),j=i.values[a],C=j===void 0?0:ve(j,i.min,i.max),x=We(a,i.values.length),S=h?.[d.size],f=S?Xe(S,C,d.direction):0;return l.useEffect(()=>{if(p)return i.thumbs.add(p),()=>{i.thumbs.delete(p)}},[p,i.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[d.startEdge]:`calc(${C}% + ${f}px)`},children:[e.jsx(X.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(L.span,{role:"slider","aria-label":s["aria-label"]||x,"aria-valuemin":i.min,"aria-valuenow":j,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...m,ref:v,style:j===void 0?{display:"none"}:s.style,onFocus:F(s.onFocus,()=>{i.valueIndexToChangeRef.current=a})})}),o&&e.jsx(ge,{name:c??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:j},a)]})});pe.displayName=Z;var Ye="RadioBubbleInput",ge=l.forwardRef(({__scopeSlider:s,value:r,...n},a)=>{const c=l.useRef(null),m=K(c,a),i=Ee(r);return l.useEffect(()=>{const d=c.current;if(!d)return;const p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"value").set;if(i!==r&&v){const o=new Event("input",{bubbles:!0});v.call(d,r),d.dispatchEvent(o)}},[i,r]),e.jsx(L.input,{style:{display:"none"},...n,ref:m,defaultValue:r})});ge.displayName=Ye;function qe(s=[],r,n){const a=[...s];return a[n]=r,a.sort((c,m)=>c-m)}function ve(s,r,n){const m=100/(n-r)*(s-r);return ne(m,[0,100])}function We(s,r){return r>2?`Value ${s+1} of ${r}`:r===2?["Minimum","Maximum"][s]:void 0}function Qe(s,r){if(s.length===1)return 0;const n=s.map(c=>Math.abs(c-r)),a=Math.min(...n);return n.indexOf(a)}function Xe(s,r,n){const a=s/2,m=ee([0,50],[0,a]);return(a-m(r)*n)*n}function Je(s){return s.slice(0,-1).map((r,n)=>s[n+1]-r)}function Ze(s,r){if(r>0){const n=Je(s);return Math.min(...n)>=r}return!0}function ee(s,r){return n=>{if(s[0]===s[1]||r[0]===r[1])return r[0];const a=(r[1]-r[0])/(s[1]-s[0]);return r[0]+a*(n-s[0])}}function et(s){return(String(s).split(".")[1]||"").length}function tt(s,r){const n=Math.pow(10,r);return Math.round(s*n)/n}var je=ce,st=xe,rt=he,nt=pe;const Se=l.forwardRef(({className:s,...r},n)=>e.jsxs(je,{ref:n,className:Te("relative flex w-full touch-none select-none items-center",s),...r,children:[e.jsx(st,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(rt,{className:"absolute h-full bg-primary"})}),e.jsx(nt,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Se.displayName=je.displayName;const ut=()=>{const s=Ce(),{toast:r}=ke(),[n]=Re(),[a,c]=l.useState([]),[m,i]=l.useState(!0),[d,p]=l.useState(""),[N,v]=l.useState("all"),[o,h]=l.useState("all"),[j,C]=l.useState("any"),[x,S]=l.useState([0,2e7]),[f,R]=l.useState([]),[b,g]=l.useState(1),[E,H]=l.useState(1),[_,I]=l.useState(new Set),O=["Swimming Pool","Gym/Fitness Center","Parking","Security","Garden/Park","Playground","Clubhouse","Power Backup","Elevator","WiFi","CCTV Surveillance","Water Supply","Fire Safety"];l.useEffect(()=>{const t=n.get("q"),u=n.get("listingType"),w=n.get("propertyType");t&&p(t),u&&u!=="all"&&v(u),w&&w!=="all"&&h(w),g(1)},[n]),l.useEffect(()=>{k()},[d,N,o,j,x,f,b]);const k=async()=>{i(!0);try{const t={page:b,limit:12};d.trim()&&(t.search=d),N!=="all"&&(t.listingType=N),o!=="all"&&(t.propertyType=o),j!=="any"&&(t.bedrooms=j),x[0]>0&&(t.minPrice=x[0]),x[1]<2e7&&(t.maxPrice=x[1]),f.length>0&&(t.amenities=f);const u=await De.getProperties(t);u.success&&(c(u.data.properties),H(u.data.pagination.totalPages))}catch(t){console.error("Error loading properties:",t),r({title:"Error",description:"Failed to load properties",variant:"destructive"})}finally{i(!1)}};l.useEffect(()=>{P()},[]);const P=async()=>{try{const t=await Q.getFavorites();if(t.success){const u=new Set(t.data.favorites.map(w=>w.property?._id).filter(Boolean));I(u)}}catch(t){console.error("Error loading favorites:",t)}},T=async t=>{try{_.has(t)?(await Q.removeFromFavorites(t),I(u=>{const w=new Set(u);return w.delete(t),w}),r({title:"Removed from favorites",description:"Property removed from your favorites"})):(await Q.addToFavorites(t),I(u=>new Set(u).add(t)),r({title:"Added to favorites",description:"Property added to your favorites"}))}catch(u){console.error("Error toggling favorite:",u),r({title:"Error",description:"Failed to update favorite",variant:"destructive"})}},B=()=>{p(""),v("all"),h("all"),C("any"),S([0,2e7]),R([]),g(1)},M=t=>t>=1e7?`₹${(t/1e7).toFixed(2)} Cr`:t>=1e5?`₹${(t/1e5).toFixed(2)} L`:`₹${t.toLocaleString()}`;return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-b",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Search Properties"}),e.jsx("p",{className:"text-muted-foreground",children:"Find your dream property from our verified listings"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("aside",{className:"lg:w-80 flex-shrink-0",children:e.jsx($,{className:"sticky top-20",children:e.jsxs(U,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Be,{placeholder:"Location, property name...",value:d,onChange:t=>p(t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Listing Type"}),e.jsxs(G,{value:N,onValueChange:v,children:[e.jsx(Y,{children:e.jsx(q,{placeholder:"Type"})}),e.jsxs(W,{children:[e.jsx(y,{value:"all",children:"All Types"}),e.jsx(y,{value:"sale",children:"For Sale"}),e.jsx(y,{value:"rent",children:"For Rent"}),e.jsx(y,{value:"lease",children:"For Lease"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Property Type"}),e.jsxs(G,{value:o,onValueChange:h,children:[e.jsx(Y,{children:e.jsx(q,{placeholder:"Property"})}),e.jsxs(W,{children:[e.jsx(y,{value:"all",children:"All Properties"}),e.jsx(y,{value:"apartment",children:"Apartment"}),e.jsx(y,{value:"villa",children:"Villa"}),e.jsx(y,{value:"house",children:"House"}),e.jsx(y,{value:"plot",children:"Plot"}),e.jsx(y,{value:"land",children:"Land"}),e.jsx(y,{value:"commercial",children:"Commercial"}),e.jsx(y,{value:"office",children:"Office"}),e.jsx(y,{value:"pg",children:"PG"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Bedrooms"}),e.jsxs(G,{value:j,onValueChange:C,children:[e.jsx(Y,{children:e.jsx(q,{placeholder:"BHK"})}),e.jsxs(W,{children:[e.jsx(y,{value:"any",children:"Any BHK"}),e.jsx(y,{value:"1",children:"1 BHK"}),e.jsx(y,{value:"2",children:"2 BHK"}),e.jsx(y,{value:"3",children:"3 BHK"}),e.jsx(y,{value:"4",children:"4+ BHK"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Price Range"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Se,{value:x,onValueChange:S,min:0,max:2e7,step:1e5,className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Min Price"}),e.jsx("span",{className:"font-semibold text-primary",children:M(x[0])})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Max Price"}),e.jsx("span",{className:"font-semibold text-primary",children:M(x[1])})]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Amenities"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 border rounded-md p-3",children:O.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(He,{id:t,checked:f.includes(t),onCheckedChange:u=>{R(u?[...f,t]:f.filter(w=>w!==t))}}),e.jsx("label",{htmlFor:t,className:"text-sm font-normal cursor-pointer leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))}),f.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[f.length," selected"]})]}),e.jsx(A,{variant:"outline",onClick:B,className:"w-full",children:"Reset Filters"})]})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Available Properties"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m?"Loading...":`${a.length} properties found`})]}),m?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(Me,{className:"h-8 w-8 animate-spin text-primary"})}):a.length===0?e.jsx($,{children:e.jsxs(U,{className:"p-12 text-center",children:[e.jsx(se,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No properties found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your filters or search criteria"}),e.jsx(A,{onClick:B,children:"Clear Filters"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:a.map(t=>e.jsxs($,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"relative h-48 bg-muted",onClick:()=>s(`/property/${t._id}`),children:[t.images&&t.images.length>0?e.jsx("img",{src:typeof t.images[0]=="string"?t.images[0]:t.images[0]?.url,alt:t.title,className:"w-full h-full object-cover",onError:u=>{const w=u.target;w.src="/placeholder-property.jpg"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(se,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx(A,{size:"icon",variant:"secondary",className:"absolute top-2 right-2",onClick:u=>{u.stopPropagation(),T(t._id)},children:e.jsx(Ae,{className:`h-4 w-4 ${_.has(t._id)?"fill-red-500 text-red-500":""}`})}),e.jsx(re,{className:"absolute top-2 left-2 capitalize",children:t.listingType})]}),e.jsxs(U,{className:"p-4",onClick:()=>s(`/customer/property/${t._id}`),children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:t.title}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{className:"line-clamp-1",children:[t.address.city,", ",t.address.state]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:M(t.price)}),t.listingType==="rent"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"/month"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.bedrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:t.bedrooms})]}),t.bathrooms>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx("span",{children:t.bathrooms})]}),t.area?.builtUp&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.area.builtUp," sqft"]})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsx(re,{variant:"outline",className:"capitalize",children:t.type})})]})]},t._id))}),E>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-8",children:[e.jsx(A,{variant:"outline",disabled:b===1,onClick:()=>g(t=>t-1),children:"Previous"}),e.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:E},(t,u)=>u+1).map(t=>e.jsx(A,{variant:b===t?"default":"outline",onClick:()=>g(t),className:"w-10",children:t},t))}),e.jsx(A,{variant:"outline",disabled:b===E,onClick:()=>g(t=>t+1),children:"Next"})]})]})]})]})})]})};export{ut as default};
