import{j as e}from"./ui-CMGlPv8M.js";import{r as i,d as J}from"./router-02yfTqxa.js";import{G as K,u as X,Q as T,R as r,B as d,f as m,E as ee,V as L,W as z,Y as O,Z as B,$ as H,a as h,b as j,c as u,y as se,e as p,S as ae,h as te,r as le,s as ie,v as re,w as ne,x as de,a0 as ce,I as oe}from"./index-DGiQKbnC.js";import{T as me,a as xe,b as k,c as o,d as he,e as c}from"./table-B9xM5EYE.js";import{P as je,a as ue,b as w,c as pe,d as fe,e as ge}from"./pagination-YbYwwe1g.js";import{A as Ne,a as ve,b as be,c as ye,d as Ce,e as we,f as Ue,g as Pe,h as Se}from"./alert-dialog-Cen20FWz.js";import{T as De}from"./trash-2-DzllJ_4S.js";import{A as Ae}from"./activity-B_LWE1x-.js";import{C as Te}from"./calendar-CnnZ5ZoT.js";import"./vendor-Dazix4UH.js";import"./ellipsis-v9J3hQEd.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=K("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),Ve=({searchQuery:x})=>{const{isSuperAdmin:v}=X(),[l,f]=i.useState(1),[V,U]=i.useState([]),[M,I]=i.useState(!0),[g,P]=i.useState(0),[Ie,S]=i.useState(0),[E,F]=i.useState(null),[s,b]=i.useState(null),[W,D]=i.useState(!1),[G,y]=i.useState(!1),[R,_]=i.useState(null),[N,C]=i.useState(""),A=10;i.useEffect(()=>{(async()=>{I(!0);try{const t=await r.getUsers({page:l,limit:A,search:x||void 0});t.success&&(U(t.data.users),P(t.data.pagination.totalPages),S(t.data.pagination.totalUsers))}catch(t){console.error("Failed to fetch users:",t)}finally{I(!1)}})()},[l,x]);const Q=async a=>{F(a);try{await r.deleteUser(a);const t=await r.getUsers({page:l,limit:A,search:x||void 0});t.success&&(U(t.data.users),P(t.data.pagination.totalPages),S(t.data.pagination.totalUsers))}catch(t){console.error("Failed to delete user:",t)}finally{F(null)}},Y=a=>{b(a),D(!0)},Z=a=>{b(a),C(a.role),y(!0)},$=async()=>{if(!(!s||!N)){_(s._id);try{await r.promoteUser(s._id,N);const a=await r.getUsers({page:l,limit:A,search:x||void 0});a.success&&(U(a.data.users),P(a.data.pagination.totalPages),S(a.data.pagination.totalUsers)),y(!1),b(null),C("")}catch(a){console.error("Failed to promote user:",a)}finally{_(null)}}},q=["customer","agent","subadmin","superadmin"];return M?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(T,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(me,{children:[e.jsx(xe,{children:e.jsxs(k,{children:[e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Email"}),e.jsx(o,{className:"hidden md:table-cell",children:"Phone"}),e.jsx(o,{className:"hidden sm:table-cell",children:"Role"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Status"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Created"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(he,{children:V.length===0?e.jsx(k,{children:e.jsx(c,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found."})}):V.map(a=>e.jsxs(k,{children:[e.jsx(c,{className:"font-medium",children:r.getFullName(a)}),e.jsx(c,{children:a.email}),e.jsx(c,{className:"hidden md:table-cell",children:a.profile.phone||"-"}),e.jsx(c,{className:"hidden sm:table-cell",children:e.jsx(d,{variant:a.role==="admin"?"default":"secondary",children:a.role})}),e.jsx(c,{className:"hidden lg:table-cell",children:e.jsx(d,{variant:a.status==="active"?"default":a.status==="pending"?"secondary":"destructive",children:a.status})}),e.jsx(c,{className:"hidden lg:table-cell",children:r.formatCreationDate(a.createdAt)}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>Y(a),title:"View User Details",children:e.jsx(ee,{className:"h-4 w-4"})}),v&&e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>Z(a),title:"Promote User",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsxs(Ne,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"icon",children:e.jsx(De,{className:"h-4 w-4"})})}),e.jsxs(be,{children:[e.jsxs(ye,{children:[e.jsx(Ce,{children:"Are you absolutely sure?"}),e.jsx(we,{children:"This action cannot be undone. This will permanently delete the user account and remove their data from our servers."})]}),e.jsxs(Ue,{children:[e.jsx(Pe,{children:"Cancel"}),e.jsxs(Se,{onClick:()=>Q(a._id),disabled:E===a._id,children:[E===a._id?e.jsx(T,{className:"h-4 w-4 animate-spin mr-2"}):null,"Delete"]})]})]})]})]})})]},a._id))})]})}),g>1&&e.jsx(je,{className:"mt-4",children:e.jsxs(ue,{children:[e.jsx(w,{children:e.jsx(pe,{onClick:()=>f(a=>Math.max(1,a-1)),className:l===1?"pointer-events-none opacity-50":"cursor-pointer"})}),[...Array(g)].map((a,t)=>{const n=t+1;return n===1||n===g||n>=l-1&&n<=l+1?e.jsx(w,{children:e.jsx(fe,{onClick:()=>f(n),isActive:l===n,className:"cursor-pointer",children:n})},n):n===l-2||n===l+2?e.jsx(w,{children:"..."},n):null}),e.jsx(w,{children:e.jsx(ge,{onClick:()=>f(a=>Math.min(g,a+1)),className:l===g?"pointer-events-none opacity-50":"cursor-pointer"})})]})}),e.jsx(L,{open:W,onOpenChange:D,children:e.jsxs(z,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(B,{children:"User Details"}),e.jsxs(H,{children:["Complete information about ",s?r.getFullName(s):"user"]})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Basic Information"]})}),e.jsx(p,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"text-base",children:r.getFullName(s)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-base",children:s.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"text-base",children:s.profile?.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"User ID"}),e.jsx("p",{className:"text-base font-mono text-sm",children:s._id})]})]})})]}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),"Account Status"]})}),e.jsx(p,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx(d,{variant:s.role==="admin"?"default":"secondary",className:"mt-1",children:s.role})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(d,{variant:s.status==="active"?"default":s.status==="pending"?"secondary":"destructive",className:"mt-1",children:s.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email Verified"}),e.jsx(d,{variant:s.profile?.emailVerified?"default":"destructive",className:"mt-1",children:s.profile?.emailVerified?"Verified":"Not Verified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone Verified"}),e.jsx(d,{variant:s.profile?.phoneVerified?"default":"destructive",className:"mt-1",children:s.profile?.phoneVerified?"Verified":"Not Verified"})]})]})})]}),s.profile?.address&&e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Address Information"]})}),e.jsx(p,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.profile?.address?.street&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Street"}),e.jsx("p",{className:"text-base",children:s.profile.address.street})]}),s.profile?.address?.city&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"City"}),e.jsx("p",{className:"text-base",children:s.profile.address.city})]}),s.profile?.address?.state&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"State"}),e.jsx("p",{className:"text-base",children:s.profile.address.state})]}),s.profile?.address?.zipCode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pincode"}),e.jsx("p",{className:"text-base",children:s.profile.address.zipCode})]})]})})]}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"User Preferences"]})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Language"}),e.jsx("p",{className:"text-base",children:"Not available"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Currency"}),e.jsx("p",{className:"text-base",children:"Not available"})]})]}),s.profile?.preferences?.notifications&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Notification Preferences"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(d,{variant:s.profile.preferences.notifications.email?"default":"secondary",children:["Email: ",s.profile.preferences.notifications.email?"Enabled":"Disabled"]}),e.jsxs(d,{variant:s.profile.preferences.notifications.sms?"default":"secondary",children:["SMS: ",s.profile.preferences.notifications.sms?"Enabled":"Disabled"]}),e.jsxs(d,{variant:s.profile.preferences.notifications.push?"default":"secondary",children:["Push: ",s.profile.preferences.notifications.push?"Enabled":"Disabled"]})]})]})]})]}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5"}),"Account Timeline"]})}),e.jsx(p,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Created At"}),e.jsx("p",{className:"text-base",children:r.formatCreationDate(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-base",children:r.formatCreationDate(s.updatedAt)})]})]})})]}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(u,{children:"Quick Actions"})}),e.jsx(p,{children:e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsx(m,{variant:"outline",size:"sm",onClick:()=>D(!1),children:"Close"})})})]})]})]})}),e.jsx(L,{open:G,onOpenChange:y,children:e.jsxs(z,{children:[e.jsxs(O,{children:[e.jsx(B,{children:"Promote User"}),e.jsxs(H,{children:["Change the role of ",s?r.getFullName(s):"user"]})]}),s&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Role"}),e.jsx(d,{variant:"secondary",children:s.role})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"New Role"}),e.jsxs(le,{value:N,onValueChange:C,children:[e.jsx(ie,{children:e.jsx(re,{placeholder:"Select a role"})}),e.jsx(ne,{children:q.map(a=>e.jsx(de,{value:a,children:a},a))})]})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"Warning:"})," Changing a user's role will affect their permissions and access to features."]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{variant:"outline",onClick:()=>{y(!1),b(null),C("")},children:"Cancel"}),e.jsx(m,{onClick:$,disabled:!N||N===s.role||R===s._id,children:R===s._id?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 animate-spin mr-2"}),"Promoting..."]}):"Promote User"})]})]})]})})]})},Ge=()=>{const x=J(),[v,l]=i.useState("");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Users"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage system users"})]}),e.jsxs(m,{onClick:()=>x("/admin/users/add"),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),e.jsxs("div",{className:"bg-card rounded-lg border p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(oe,{placeholder:"Search users...",value:v,onChange:f=>l(f.target.value),className:"max-w-md"})}),e.jsx(Ve,{searchQuery:v})]})]})};export{Ge as default};
