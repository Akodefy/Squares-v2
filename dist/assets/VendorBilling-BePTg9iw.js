import{j as e}from"./ui-CMGlPv8M.js";import{r as u}from"./router-02yfTqxa.js";import{t as m,Q as L,V as H,W as Y,Y as G,Z as J,$ as Q,B as y,f as h,r as ue,s as he,v as pe,w as ge,x as R,a as f,e as N,a5 as je,a6 as fe,a7 as k,au as F,b as S,c as D,aC as W,a0 as Ne,E as X,o as O,aP as Z,H as ve,n as be,C as ye}from"./index-DGiQKbnC.js";import{D as w}from"./download-Dx_JF_-F.js";import{T as we}from"./trending-up-DL-k5KbV.js";import{D as A}from"./dollar-sign-CYcO9sIf.js";import{C as K}from"./circle-alert-YlyZ8R6H.js";import"./vendor-Dazix4UH.js";const E="https://api.akodefy.com/api";class Se{async makeRequest(a,t={}){const r=`${E}${a}`,n={headers:{"Content-Type":"application/json",...t.headers},...t},g=localStorage.getItem("token");g&&(n.headers={...n.headers,Authorization:`Bearer ${g}`});try{const l=await fetch(r,n);if(!l.ok){const v=await l.json().catch(()=>({success:!1,message:`HTTP ${l.status}: ${l.statusText}`}));throw new Error(v.message||"An error occurred")}return await l.json()}catch(l){throw console.error("Billing API request failed:",l),l}}async getSubscriptionPlans(){try{const a=await this.makeRequest("/billing/plans");return a.success?a.data:[]}catch(a){return console.error("Failed to fetch subscription plans:",a),[]}}async getCurrentSubscription(){try{const a=await this.makeRequest("/vendors/subscription/current");return a.success?a.data:null}catch(a){return console.error("Failed to fetch current subscription:",a),null}}async upgradeSubscription(a,t){try{const r=await this.makeRequest("/vendors/subscription/upgrade",{method:"POST",body:JSON.stringify({planId:a,billingCycle:t})});return r.success&&m({title:"Success",description:r.message||"Subscription upgrade initiated!"}),{success:r.success,paymentUrl:r.data?.paymentUrl,message:r.message}}catch(r){const n=r instanceof Error?r.message:"Failed to upgrade subscription";return m({title:"Error",description:n,variant:"destructive"}),{success:!1,message:n}}}async cancelSubscription(a){try{const t=await this.makeRequest("/vendors/subscription/cancel",{method:"POST",body:JSON.stringify({reason:a})});if(t.success)return m({title:"Success",description:t.message||"Subscription cancelled successfully!"}),!0;throw new Error(t.message||"Failed to cancel subscription")}catch(t){const r=t instanceof Error?t.message:"Failed to cancel subscription";return m({title:"Error",description:r,variant:"destructive"}),!1}}async reactivateSubscription(){try{const a=await this.makeRequest("/vendors/subscription/reactivate",{method:"POST"});if(a.success)return m({title:"Success",description:a.message||"Subscription reactivated successfully!"}),!0;throw new Error(a.message||"Failed to reactivate subscription")}catch(a){const t=a instanceof Error?a.message:"Failed to reactivate subscription";return m({title:"Error",description:t,variant:"destructive"}),!1}}async getPayments(a={}){try{const t=new URLSearchParams;Object.entries(a).forEach(([g,l])=>{l!=null&&l!==""&&t.append(g,l.toString())});const r=`/vendors/payments${t.toString()?`?${t.toString()}`:""}`,n=await this.makeRequest(r);return n.success&&n.data?n.data:{payments:[],totalCount:0,totalPages:0,currentPage:1}}catch(t){return console.error("Failed to fetch payments:",t),{payments:[],totalCount:0,totalPages:0,currentPage:1}}}async getInvoices(a={}){try{const t=new URLSearchParams;Object.entries(a).forEach(([g,l])=>{l!=null&&l!==""&&t.append(g,l.toString())});const r=`/vendors/invoices${t.toString()?`?${t.toString()}`:""}`,n=await this.makeRequest(r);return n.success&&n.data?n.data:{invoices:[],totalCount:0,totalPages:0,currentPage:1}}catch(t){return console.error("Failed to fetch invoices:",t),{invoices:[],totalCount:0,totalPages:0,currentPage:1}}}async downloadInvoice(a){try{const t=await fetch(`${E}/vendors/invoices/${a}/download`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.ok)throw new Error("Failed to download invoice");const r=await t.blob();return m({title:"Success",description:"Invoice downloaded successfully!"}),r}catch(t){const r=t instanceof Error?t.message:"Failed to download invoice";return m({title:"Error",description:r,variant:"destructive"}),null}}async getBillingStats(){try{const a=await this.makeRequest("/vendors/billing/stats");return a.success&&a.data?a.data:{totalRevenue:0,monthlyRevenue:0,activeSubscriptions:0,totalInvoices:0,paidInvoices:0,overdueInvoices:0,nextBillingAmount:0,nextBillingDate:new Date().toISOString(),subscriptionStatus:"inactive",usageStats:{properties:{used:0,limit:0},leads:{used:0,limit:0},messages:{used:0,limit:0}}}}catch(a){return console.error("Failed to fetch billing stats:",a),{totalRevenue:0,monthlyRevenue:0,activeSubscriptions:0,totalInvoices:0,paidInvoices:0,overdueInvoices:0,nextBillingAmount:0,nextBillingDate:new Date().toISOString(),subscriptionStatus:"inactive",usageStats:{properties:{used:0,limit:0},leads:{used:0,limit:0},messages:{used:0,limit:0}}}}}formatCurrency(a){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}formatDate(a){return new Date(a).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}getStatusColor(a){return{active:"text-green-600 bg-green-100",cancelled:"text-red-600 bg-red-100",expired:"text-orange-600 bg-orange-100",pending:"text-yellow-600 bg-yellow-100",trial:"text-blue-600 bg-blue-100",completed:"text-green-600 bg-green-100",failed:"text-red-600 bg-red-100",refunded:"text-purple-600 bg-purple-100",paid:"text-green-600 bg-green-100",overdue:"text-red-600 bg-red-100",sent:"text-blue-600 bg-blue-100",draft:"text-gray-600 bg-gray-100"}[a]||"text-gray-600 bg-gray-100"}getUsagePercentage(a,t){return t===0?0:Math.min(a/t*100,100)}downloadBlob(a,t){const r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}async getPaymentDetails(a){try{const t=await this.makeRequest(`/vendors/payments/${a}`);return t.success?t.data:null}catch(t){return console.error("Failed to fetch payment details:",t),m({title:"Error",description:"Failed to load payment details",variant:"destructive"}),null}}async getInvoiceDetails(a){try{const t=await this.makeRequest(`/vendors/invoices/${a}`);return t.success?t.data:null}catch(t){return console.error("Failed to fetch invoice details:",t),m({title:"Error",description:"Failed to load invoice details",variant:"destructive"}),null}}async downloadReceipt(a){try{const t=await fetch(`${E}/vendors/payments/${a}/receipt`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.ok)throw new Error("Failed to download receipt");const r=await t.blob();return m({title:"Success",description:"Receipt downloaded successfully!"}),r}catch(t){const r=t instanceof Error?t.message:"Failed to download receipt";return m({title:"Error",description:r,variant:"destructive"}),null}}async exportBillingData(a,t={}){try{const r=new URLSearchParams;r.append("format",a),Object.entries(t).forEach(([l,v])=>{v!=null&&v!==""&&r.append(l,v.toString())});const n=await fetch(`${E}/vendors/billing/export?${r.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!n.ok)throw new Error("Failed to export billing data");const g=await n.blob();return m({title:"Success",description:"Billing data exported successfully!"}),g}catch(r){const n=r instanceof Error?r.message:"Failed to export billing data";return m({title:"Error",description:n,variant:"destructive"}),null}}}const p=new Se,Ee=()=>{const[U,a]=u.useState(!0),[t,r]=u.useState(null),[n,g]=u.useState([]),[l,v]=u.useState([]),[o,ee]=u.useState(null),[P,se]=u.useState("last_30_days"),[te,ae]=u.useState("overview"),[d,re]=u.useState(null),[c,ie]=u.useState(null),[ne,$]=u.useState(!1),[le,B]=u.useState(!1),[M,C]=u.useState(!1);u.useEffect(()=>{ce()},[P]);const q=s=>{const i=new Date,_={last_7_days:7,last_30_days:30,last_90_days:90,last_year:365}[s]||30;return new Date(i.getTime()-_*24*60*60*1e3).toISOString().split("T")[0]},ce=async()=>{try{a(!0);const[s,i,_,V]=await Promise.all([p.getCurrentSubscription(),p.getPayments({page:1,limit:20,dateFrom:q(P)}),p.getInvoices({page:1,limit:10}),p.getBillingStats()]);r(s),g(i.payments||[]),v(_.invoices||[]),ee(V)}catch(s){console.error("Failed to load billing data:",s),m({title:"Error",description:"Failed to load billing information. Please try again.",variant:"destructive"})}finally{a(!1)}},I=s=>{switch(s){case"completed":case"active":case"paid":return e.jsx(ye,{className:"w-4 h-4 text-green-600"});case"pending":case"sent":return e.jsx(be,{className:"w-4 h-4 text-yellow-600"});case"failed":return e.jsx(K,{className:"w-4 h-4 text-red-600"});case"cancelled":case"expired":case"overdue":return e.jsx(ve,{className:"w-4 h-4 text-red-600"});default:return e.jsx(K,{className:"w-4 h-4 text-gray-600"})}},b=s=>{switch(s){case"completed":case"active":case"paid":return"bg-green-100 text-green-800";case"pending":case"sent":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";case"cancelled":case"expired":case"overdue":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},x=(s,i="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:i,minimumFractionDigits:0,maximumFractionDigits:0}).format(s),j=s=>new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),oe=async()=>{try{const s=await p.exportBillingData("pdf",{dateFrom:q(P)});s&&p.downloadBlob(s,`billing-report-${new Date().toISOString().split("T")[0]}.pdf`)}catch(s){console.error("Export failed:",s)}},de=async s=>{C(!0),$(!0);try{const i=await p.getPaymentDetails(s);i&&re(i)}catch(i){console.error("Failed to load payment details:",i),$(!1)}finally{C(!1)}},z=async s=>{try{const i=await p.downloadReceipt(s._id);i&&p.downloadBlob(i,`receipt-${s._id.slice(-8)}.pdf`)}catch(i){console.error("Failed to download receipt:",i)}},me=async s=>{C(!0),B(!0);try{const i=await p.getInvoiceDetails(s);i&&ie(i)}catch(i){console.error("Failed to load invoice details:",i),B(!1)}finally{C(!1)}},T=async s=>{try{const i=await p.downloadInvoice(s._id);i&&p.downloadBlob(i,`invoice-${s.invoiceNumber}.pdf`)}catch(i){console.error("Failed to download invoice:",i)}},xe=async()=>{try{for(const s of l)await T(s),await new Promise(i=>setTimeout(i,500));m({title:"Success",description:`Downloaded ${l.length} invoices`})}catch(s){console.error("Failed to download all invoices:",s)}};return U?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading billing information..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(H,{open:ne,onOpenChange:$,children:e.jsxs(Y,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Payment Details"}),e.jsx(Q,{children:"Complete information about this payment transaction"})]}),M?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(L,{className:"h-6 w-6 animate-spin"})}):d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payment ID"}),e.jsx("p",{className:"font-medium",children:d._id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Transaction ID"}),e.jsx("p",{className:"font-medium",children:d.transactionId||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Amount"}),e.jsx("p",{className:"font-medium text-lg",children:x(d.amount,d.currency)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(y,{className:b(d.status),children:d.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payment Method"}),e.jsx("p",{className:"font-medium capitalize",children:d.paymentMethod.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payment Gateway"}),e.jsx("p",{className:"font-medium capitalize",children:d.paymentGateway})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Created At"}),e.jsx("p",{className:"font-medium",children:j(d.createdAt)})]}),d.paidAt&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Paid At"}),e.jsx("p",{className:"font-medium",children:j(d.paidAt)})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx("p",{className:"font-medium",children:d.description})]}),d.failureReason&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Failure Reason"}),e.jsx("p",{className:"text-sm text-red-800",children:d.failureReason})]}),e.jsx("div",{className:"flex gap-2 pt-4",children:e.jsxs(h,{onClick:()=>z(d),className:"w-full",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Download Receipt"]})})]}):e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"No payment details available"})]})}),e.jsx(H,{open:le,onOpenChange:B,children:e.jsxs(Y,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Invoice Details"}),e.jsx(Q,{children:"Complete information about this invoice"})]}),M?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(L,{className:"h-6 w-6 animate-spin"})}):c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Invoice Number"}),e.jsx("p",{className:"font-medium text-lg",children:c.invoiceNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(y,{className:b(c.status),children:c.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Issue Date"}),e.jsx("p",{className:"font-medium",children:j(c.issueDate)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Due Date"}),e.jsx("p",{className:"font-medium",children:j(c.dueDate)})]}),c.paidDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Paid Date"}),e.jsx("p",{className:"font-medium",children:j(c.paidDate)})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Vendor Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",c.vendorDetails.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Email:"})," ",c.vendorDetails.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",c.vendorDetails.phone]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Address:"})," ",c.vendorDetails.address]}),c.vendorDetails.gst&&e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"GST:"})," ",c.vendorDetails.gst]})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 text-sm font-medium",children:"Description"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium",children:"Qty"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium",children:"Unit Price"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium",children:"Total"})]})}),e.jsx("tbody",{children:c.items.map((s,i)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 text-sm",children:s.description}),e.jsx("td",{className:"p-3 text-sm text-right",children:s.quantity}),e.jsx("td",{className:"p-3 text-sm text-right",children:x(s.unitPrice,c.currency)}),e.jsx("td",{className:"p-3 text-sm text-right font-medium",children:x(s.total,c.currency)})]},i))}),e.jsxs("tfoot",{className:"border-t-2",children:[e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{colSpan:3,className:"p-3 text-sm text-right font-medium",children:"Subtotal"}),e.jsx("td",{className:"p-3 text-sm text-right font-medium",children:x(c.amount,c.currency)})]}),e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{colSpan:3,className:"p-3 text-sm text-right font-medium",children:"Tax"}),e.jsx("td",{className:"p-3 text-sm text-right font-medium",children:x(c.tax,c.currency)})]}),e.jsxs("tr",{className:"border-t bg-muted",children:[e.jsx("td",{colSpan:3,className:"p-3 text-base text-right font-bold",children:"Total"}),e.jsx("td",{className:"p-3 text-base text-right font-bold",children:x(c.total,c.currency)})]})]})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{onClick:()=>T(c),className:"w-full",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Download PDF"]})})]}):e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"No invoice details available"})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Billing & Payments"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your subscription and payment history"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ue,{value:P,onValueChange:se,children:[e.jsx(he,{className:"w-40",children:e.jsx(pe,{placeholder:"Select period"})}),e.jsxs(ge,{children:[e.jsx(R,{value:"last_7_days",children:"Last 7 days"}),e.jsx(R,{value:"last_30_days",children:"Last 30 days"}),e.jsx(R,{value:"last_90_days",children:"Last 90 days"}),e.jsx(R,{value:"last_year",children:"Last year"})]})]}),e.jsxs(h,{variant:"outline",onClick:oe,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(f,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x(o.totalRevenue)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Revenue"})]})}),e.jsx(f,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x(o.nextBillingAmount)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Next Payment"})]})}),e.jsx(f,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:o.totalInvoices}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Invoices"})]})}),e.jsx(f,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t?x(t.amount):"₹0"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Monthly Cost"})]})})]}),e.jsxs(je,{value:te,onValueChange:ae,className:"space-y-6",children:[e.jsxs(fe,{children:[e.jsx(k,{value:"overview",children:"Overview"}),e.jsx(k,{value:"payments",children:"Payment History"}),e.jsx(k,{value:"invoices",children:"Invoices"}),e.jsx(k,{value:"usage",children:"Usage Stats"})]}),e.jsxs(F,{value:"overview",className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs(D,{className:"flex items-center",children:[e.jsx(W,{className:"w-5 h-5 mr-2"}),"Current Subscription"]})}),e.jsx(N,{children:t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.plan?.name||"N/A"}),e.jsxs("p",{className:"text-muted-foreground",children:[t.billingCycle==="monthly"?"Monthly":"Yearly"," Plan"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[I(t.status),e.jsx(y,{className:b(t.status),children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly Cost"}),e.jsx("p",{className:"text-lg font-semibold",children:x(t.amount,t.currency)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Next Billing Date"}),e.jsx("p",{className:"text-lg font-semibold",children:j(t.nextBillingDate)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Auto Renewal"}),e.jsx("p",{className:"text-lg font-semibold",children:t.autoRenew?"Enabled":"Disabled"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>window.location.href="/vendor/subscription-plans",children:"Change Plan"}),e.jsx(h,{variant:"outline",onClick:()=>window.location.href="/vendor/subscription-manager",children:"Manage Subscription"})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Active Subscription"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Choose a plan to get started with our services"}),e.jsxs(h,{onClick:()=>window.location.href="/vendor/subscription-plans",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Choose Plan"]})]})})]}),e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs(D,{className:"flex items-center",children:[e.jsx(we,{className:"w-5 h-5 mr-2"}),"Recent Transactions"]})}),e.jsx(N,{children:n&&n.length>0?e.jsx("div",{className:"space-y-4",children:n.slice(0,5).map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-muted rounded-full",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s?.description||"Subscription Payment"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s?.paymentMethod||"Credit Card"," • ",s?.createdAt?j(s.createdAt):"N/A"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[I(s?.status||"pending"),e.jsx("span",{className:"font-semibold",children:x(s?.amount||0,s?.currency||"INR")})]}),e.jsx(y,{className:`text-xs ${b(s?.status||"pending")}`,children:s?.status||"pending"})]})]},s?._id||`payment-${i}`))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No transactions found"})]})})]})]}),e.jsx(F,{value:"payments",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsx(D,{children:"Payment History"})}),e.jsx(N,{children:n&&n.length>0?e.jsx("div",{className:"space-y-4",children:n.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-muted rounded-full",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s?.description||"Subscription Payment"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Payment ID: ",s?._id?.slice(-8)||"N/A"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s?.createdAt?j(s.createdAt):"N/A"}),(s.status==="failed"||s.status==="cancelled")&&s.failureReason&&e.jsx("p",{className:"text-xs text-red-600 mt-1 max-w-md",children:s.failureReason.includes("timeout")||s.failureReason.includes("exceeded")?"⏱️ Payment expired - exceeded 15-minute time limit":`❌ ${s.failureReason}`})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[I(s.status),e.jsx("span",{className:"font-semibold",children:x(s.amount,s.currency)})]}),e.jsx(y,{className:`text-xs ${b(s.status)}`,children:s.status}),e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>de(s._id),children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"View"]}),e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>z(s),children:[e.jsx(w,{className:"w-4 h-4 mr-1"}),"Receipt"]})]})]})]},s?._id||`payment-full-${i}`))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Payment History"}),e.jsx("p",{className:"text-muted-foreground",children:"Your payment history will appear here"})]})})]})}),e.jsx(F,{value:"invoices",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs(D,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),"Invoices"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:xe,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Download All"]})]})}),e.jsx(N,{children:l&&l.length>0?e.jsx("div",{className:"space-y-4",children:l.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-muted rounded-full",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Invoice #",s?.invoiceNumber||"N/A"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Issued: ",s?.issueDate?j(s.issueDate):"N/A"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Due: ",j(s.dueDate)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[I(s.status),e.jsx("span",{className:"font-semibold",children:x(s.total,s.currency)})]}),e.jsx(y,{className:`text-xs ${b(s.status)}`,children:s.status}),e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>me(s._id),children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"View"]}),e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>T(s),children:[e.jsx(w,{className:"w-4 h-4 mr-1"}),"Download"]})]})]})]},s?._id||`invoice-${i}`))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(O,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Invoices"}),e.jsx("p",{className:"text-muted-foreground",children:"Your invoices will appear here"})]})})]})}),e.jsx(F,{value:"usage",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs(D,{className:"flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),"Usage Statistics"]})}),e.jsx(N,{children:o?.usageStats?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Properties"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o?.usageStats?.properties?.used||0," / ",o?.usageStats?.properties?.limit||0]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((o?.usageStats?.properties?.used||0)/(o?.usageStats?.properties?.limit||1)*100,100)}%`}})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Leads"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o?.usageStats?.leads?.used||0," / ",o?.usageStats?.leads?.limit||0]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((o?.usageStats?.leads?.used||0)/(o?.usageStats?.leads?.limit||1)*100,100)}%`}})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Messages"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o?.usageStats?.messages?.used||0," / ",o?.usageStats?.messages?.limit||0]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((o?.usageStats?.messages?.used||0)/(o?.usageStats?.messages?.limit||1)*100,100)}%`}})})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Usage resets on your billing cycle date: ",o.nextBillingDate]}),e.jsx(h,{variant:"outline",onClick:()=>window.location.href="/vendor/subscription-manager",children:"Upgrade Plan"})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Usage Data"}),e.jsx("p",{className:"text-muted-foreground",children:"Usage statistics will appear here"})]})})]})})]})]})};export{Ee as default};
