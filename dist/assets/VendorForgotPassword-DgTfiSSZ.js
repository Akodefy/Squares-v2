import{j as e}from"./ui-CMGlPv8M.js";import{d as O,r,L as v}from"./router-02yfTqxa.js";import{N as T,B as L,a as k,e as q,L as u,M as D,I as p,f as w,D as M,E as A,F as B,t}from"./index-DGiQKbnC.js";import{S as I}from"./store-BLxR4Kl-.js";import{L as j}from"./lock-aqfC1785.js";import{E as V}from"./eye-off-CFJDzV2J.js";import"./vendor-Dazix4UH.js";const Q=()=>{const y=O(),[a,x]=r.useState("email"),[i,g]=r.useState(""),[h,N]=r.useState(""),[n,P]=r.useState(""),[f,b]=r.useState(""),[d,S]=r.useState(!1),[c,m]=r.useState(!1),[C,E]=r.useState(10),R=async s=>{if(s.preventDefault(),!i){t({title:"Email Required",description:"Please enter your email address",variant:"destructive"});return}m(!0);try{const o=await(await fetch("https://api.akodefy.com/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i})})).json();o.success?(x("otp"),o.expiryMinutes&&E(o.expiryMinutes),t({title:"OTP Sent!",description:"Check your email for the password reset code."})):t({title:"Error",description:o.message||"Failed to send OTP",variant:"destructive"})}catch(l){console.error("Request OTP error:",l),t({title:"Error",description:"Failed to send OTP. Please try again.",variant:"destructive"})}finally{m(!1)}},F=async s=>{if(s.preventDefault(),!h||!n||!f){t({title:"All Fields Required",description:"Please fill in all fields",variant:"destructive"});return}if(n!==f){t({title:"Passwords Don't Match",description:"Please make sure your passwords match",variant:"destructive"});return}if(n.length<8){t({title:"Password Too Short",description:"Password must be at least 8 characters",variant:"destructive"});return}m(!0);try{const o=await(await fetch("https://api.akodefy.com/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i,otp:h,newPassword:n})})).json();o.success?(x("success"),t({title:"Password Reset!",description:"Your password has been successfully reset."})):t({title:"Reset Failed",description:o.message||"Invalid OTP or password",variant:"destructive"})}catch(l){console.error("Reset password error:",l),t({title:"Error",description:"Failed to reset password. Please try again.",variant:"destructive"})}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(T,{}),e.jsx("main",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs(L,{className:"mb-4 bg-primary/10 text-primary border-primary/20",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Vendor Portal"]}),e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[a==="email"&&"Forgot Password",a==="otp"&&"Reset Your Password",a==="success"&&"Password Reset Successful"]}),e.jsxs("p",{className:"text-muted-foreground",children:[a==="email"&&"Enter your email to receive a reset code",a==="otp"&&"Enter the OTP sent to your email",a==="success"&&"You can now login with your new password"]})]}),e.jsx(k,{children:e.jsxs(q,{className:"p-6",children:[a==="email"&&e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(p,{id:"email",type:"email",placeholder:"vendor@example.com",value:i,onChange:s=>g(s.target.value),className:"pl-10",required:!0})]})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:c,children:c?"Sending...":"Send Reset Code"}),e.jsx("div",{className:"text-center",children:e.jsxs(v,{to:"/vendor/login",className:"inline-flex items-center text-sm text-primary hover:underline",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Back to Login"]})})]}),a==="otp"&&e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"otp",children:"Verification Code"}),e.jsx(p,{id:"otp",type:"text",placeholder:"Enter 6-digit code",value:h,onChange:s=>N(s.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,required:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Code sent to ",i," â€¢ Expires in ",C," minutes"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(p,{id:"newPassword",type:d?"text":"password",placeholder:"Enter new password",value:n,onChange:s=>P(s.target.value),className:"pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>S(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d?e.jsx(V,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(A,{className:"h-5 w-5 text-muted-foreground"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(p,{id:"confirmPassword",type:d?"text":"password",placeholder:"Confirm new password",value:f,onChange:s=>b(s.target.value),className:"pl-10",required:!0})]})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:c,children:c?"Resetting...":"Reset Password"}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>x("email"),className:"text-sm text-primary hover:underline",children:"Didn't receive code? Try again"})})]}),a==="success"&&e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(j,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Set!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your password has been successfully reset."})]}),e.jsx(w,{onClick:()=>y("/vendor/login"),className:"w-full",children:"Go to Vendor Login"})]})]})}),e.jsx("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:e.jsxs("p",{children:["Don't have a vendor account?"," ",e.jsx(v,{to:"/vendor/register",className:"text-primary hover:underline",children:"Register here"})]})})]})}),e.jsx(B,{})]})};export{Q as default};
