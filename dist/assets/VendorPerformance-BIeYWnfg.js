import{j as e,a7 as w,a8 as E}from"./ui-CMGlPv8M.js";import{r}from"./router-02yfTqxa.js";import{g as V,a1 as B,a as n,b as o,c as x,q as p,e as c,aB as g,J as $,I as M,B as b,d as k,ag as F,f as I,E as L,V as O,W as z,Y as J,Z as q,$ as H}from"./index-DGiQKbnC.js";import{f as W,h as G}from"./apiUtils-Cw-_rb0N.js";import{T as y}from"./trending-up-DL-k5KbV.js";import{T as U}from"./trending-down-CKfKx8F3.js";import"./vendor-Dazix4UH.js";const S=r.forwardRef(({className:t,value:i,...m},d)=>e.jsx(w,{ref:d,className:V("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...m,children:e.jsx(E,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(i||0)}%)`}})}));S.displayName=w.displayName;const se=()=>{const[t,i]=r.useState([]),[m,d]=r.useState(!0),[h,R]=r.useState(""),[a,P]=r.useState(null),[T,u]=r.useState(!1),[j,D]=r.useState("performanceScore"),{toast:C}=B();r.useEffect(()=>{A()},[h,j]);const A=async()=>{try{d(!0);const s=await W(`/subadmin/vendors/performance?search=${h}&sortBy=${j}`),l=await G(s);i(l.data.vendors||[])}catch(s){console.error("Error fetching vendor metrics:",s),C({title:"Error",description:s.message||"Error fetching vendor metrics",variant:"destructive"}),i([])}finally{d(!1)}},N=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",f=s=>s>=80?{label:"Excellent",variant:"default",class:"bg-green-600"}:s>=60?{label:"Good",variant:"secondary",class:"bg-yellow-600"}:{label:"Needs Improvement",variant:"destructive",class:"bg-red-600"},v=s=>s<60?`${Math.round(s)} mins`:s<1440?`${Math.round(s/60)} hrs`:`${Math.round(s/1440)} days`;return m&&t.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Performance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and analyze vendor performance metrics"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-40 bg-gray-200 rounded-lg"},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Performance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and analyze vendor performance metrics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(n,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Total Vendors"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active property vendors"})]})]}),e.jsxs(n,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Top Performers"}),e.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(s=>s.performanceScore>=80).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Excellent performance (80%+)"})]})]}),e.jsxs(n,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Average Rating"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length>0?(t.reduce((s,l)=>s+l.averageRating,0)/t.length).toFixed(1):"0.0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Overall vendor ratings"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(M,{placeholder:"Search vendors by name or email...",value:h,onChange:s=>R(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:j,onChange:s=>D(s.target.value),className:"px-4 py-2 border rounded-md bg-background",children:[e.jsx("option",{value:"performanceScore",children:"Sort by Performance"}),e.jsx("option",{value:"totalProperties",children:"Sort by Properties"}),e.jsx("option",{value:"averageRating",children:"Sort by Rating"})]})]}),e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsx(n,{children:e.jsxs(c,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(p,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Vendors Found"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"No vendor data available at the moment"})]})}):t.map(s=>{const l=f(s.performanceScore);return e.jsxs(n,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{className:"text-xl",children:s.name}),e.jsx(b,{className:l.class,children:l.label})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsx("span",{children:s.email}),s.phone&&e.jsxs("span",{children:["• ",s.phone]}),e.jsxs("span",{children:["• Joined ",new Date(s.joinedDate).toLocaleDateString()]})]})})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:`text-3xl font-bold ${N(s.performanceScore)}`,children:[s.performanceScore,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Performance Score"})]})]})}),e.jsxs(c,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:s.totalProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Properties"})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:s.averageRating.toFixed(1)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.totalReviews," Reviews"]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[s.responseRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Response Rate"})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.performanceScore>=80?e.jsx(y,{className:"h-4 w-4 text-green-600"}):e.jsx(U,{className:"h-4 w-4 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:v(s.averageResponseTime)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg Response"})]})]})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Active Properties"}),e.jsxs("span",{children:[s.activeProperties," / ",s.totalProperties]})]}),e.jsx(S,{value:s.activeProperties/s.totalProperties*100,className:"h-2"})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{P(s),u(!0)},children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"View Full Details"]})]})]},s._id)})}),e.jsx(O,{open:T,onOpenChange:u,children:e.jsxs(z,{className:"max-w-3xl",children:[e.jsxs(J,{children:[e.jsxs(q,{children:[a?.name," - Performance Details"]}),e.jsx(H,{children:"Comprehensive performance metrics and statistics"})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Contact Information"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",a.email]}),a.phone&&e.jsxs("li",{children:[e.jsx("strong",{children:"Phone:"})," ",a.phone]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Joined:"})," ",new Date(a.joinedDate).toLocaleDateString()]}),a.lastActive&&e.jsxs("li",{children:[e.jsx("strong",{children:"Last Active:"})," ",new Date(a.lastActive).toLocaleDateString()]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Performance Score"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-5xl font-bold ${N(a.performanceScore)}`,children:[a.performanceScore,"%"]}),e.jsx(b,{className:`mt-2 ${f(a.performanceScore).class}`,children:f(a.performanceScore).label})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Property Statistics"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:a.totalProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-950 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.activeProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-950 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:a.rejectedProperties}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rejected"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Customer Engagement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Average Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}),e.jsxs("span",{className:"font-semibold",children:[a.averageRating.toFixed(1)," / 5.0"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Total Reviews"}),e.jsx("span",{className:"font-semibold",children:a.totalReviews})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Total Messages"}),e.jsx("span",{className:"font-semibold",children:a.totalMessages})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Response Rate"}),e.jsxs("span",{className:"font-semibold",children:[a.responseRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Average Response Time"}),e.jsx("span",{className:"font-semibold",children:v(a.averageResponseTime)})]})]})]})]})]})})]})};export{se as default};
