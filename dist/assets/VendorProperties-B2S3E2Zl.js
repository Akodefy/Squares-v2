import{j as e}from"./ui-DOY6021Z.js";import{r as l,L as c}from"./router-2SVJvIbS.js";import{ao as r,f as i,D,a as n,e as d,ax as L,E as g,U as N,ai as k,H as K,I as X,q as F,r as V,s as M,v as A,w as a,B as v,h as ee,V as se,W as te,Y as ae,Z as u,t as w}from"./index-8dkl62y8.js";import{P as le}from"./PropertyStatusDialog-Z74pn_UZ.js";import{C as re}from"./camera-DWi2SzWe.js";import{E as ie}from"./ellipsis-vertical-nsnKvOGk.js";import{P as E}from"./pen-line-CsoOJxzw.js";import{T as U}from"./trending-up-CN39lDc_.js";import{T as ne}from"./trash-2-C5jIrlx2.js";import{C as de}from"./calendar-DLw8psl4.js";import"./vendor-Dazix4UH.js";import"./dialog-Dy1IM_sd.js";import"./label-UWGJ9NFN.js";import"./textarea-DlstSMUc.js";import"./alert-DsPhAFEb.js";import"./userService-6V1iEl1Q.js";import"./circle-alert-DW1bA-Sc.js";const Te=()=>{const[o,_]=l.useState(""),[m,R]=l.useState("all"),[x,$]=l.useState("all"),[b,P]=l.useState(!0),[S,z]=l.useState([]),[B,y]=l.useState(!1),[I,O]=l.useState(null),[j,Y]=l.useState({totalProperties:0,totalViews:0,totalLeads:0,averageRating:0}),[ce,G]=l.useState({currentPage:1,totalPages:1,totalProperties:0,hasNextPage:!1,hasPrevPage:!1});l.useEffect(()=>{h(),p()},[]),l.useEffect(()=>{h()},[o,m,x]);const h=async()=>{try{P(!0);const s={page:1,limit:10,...o&&{search:o},...m!=="all"&&{status:m},...x!=="all"&&{propertyType:x}},t=await r.getVendorProperties(s);z(t.data.properties),G(t.data.pagination)}catch(s){console.error("Failed to load properties:",s)}finally{P(!1)}},p=async()=>{try{const s=await r.getVendorPropertyStats();Y(s)}catch(s){console.error("Failed to load stats:",s)}},H=async s=>{if(window.confirm("Are you sure you want to delete this property?"))try{await r.deleteProperty(s),h(),p()}catch(t){console.error("Failed to delete property:",t)}},C=async(s,t)=>{try{await r.togglePropertyFeatured(s,!t),h()}catch(f){console.error("Failed to toggle featured status:",f)}},Q=async(s,t,f,Z)=>{try{f&&(t==="sold"||t==="rented"||t==="leased")?(await r.assignPropertyToCustomer(s,f,t,Z),w({title:"Success",description:`Property ${t} and assigned to customer successfully!`})):(await r.togglePropertyStatus(s,t),w({title:"Success",description:`Property status updated to ${t}!`})),h(),p()}catch(J){console.error("Failed to update property status:",J),w({title:"Error",description:"Failed to update property status",variant:"destructive"})}},T=s=>{O(s),y(!0)},q=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),W=s=>{const t=[];return s.address.locationName&&t.push(s.address.locationName),s.address.city&&t.push(s.address.city),s.address.state&&t.push(s.address.state),t.join(", ")||"Location not specified"};return b?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading properties..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"My Properties"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and track your property listings"})]}),e.jsx(c,{to:"/vendor/properties/add",children:e.jsxs(i,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Add Property"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(n,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Properties"}),e.jsx("p",{className:"text-2xl font-bold",children:j.totalProperties})]}),e.jsx(L,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(n,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Views"}),e.jsx("p",{className:"text-2xl font-bold",children:j.totalViews.toLocaleString()})]}),e.jsx(g,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(n,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Leads"}),e.jsx("p",{className:"text-2xl font-bold",children:j.totalLeads})]}),e.jsx(N,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx(n,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg. Rating"}),e.jsx("p",{className:"text-2xl font-bold",children:j.averageRating.toFixed(1)})]}),e.jsx(k,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx(n,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(X,{placeholder:"Search properties...",value:o,onChange:s=>_(s.target.value),className:"pl-10"})]}),e.jsxs(F,{value:m,onValueChange:R,children:[e.jsx(V,{className:"w-full sm:w-40",children:e.jsx(M,{placeholder:"Status"})}),e.jsxs(A,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"available",children:"Available"}),e.jsx(a,{value:"pending",children:"Pending"}),e.jsx(a,{value:"sold",children:"Sold"}),e.jsx(a,{value:"rented",children:"Rented"})]})]}),e.jsxs(F,{value:x,onValueChange:$,children:[e.jsx(V,{className:"w-full sm:w-40",children:e.jsx(M,{placeholder:"Type"})}),e.jsxs(A,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"apartment",children:"Apartment"}),e.jsx(a,{value:"house",children:"House"}),e.jsx(a,{value:"villa",children:"Villa"}),e.jsx(a,{value:"plot",children:"Plot"}),e.jsx(a,{value:"land",children:"Land"}),e.jsx(a,{value:"commercial",children:"Commercial"}),e.jsx(a,{value:"office",children:"Office"}),e.jsx(a,{value:"pg",children:"PG (Paying Guest)"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:S.map(s=>e.jsx(n,{className:"overflow-hidden",children:e.jsx(d,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsxs("div",{className:"lg:w-64 h-48 lg:h-auto bg-muted relative",children:[s.images&&s.images.length>0?e.jsx("img",{src:r.getPrimaryImage(s),alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-transparent flex items-center justify-center",children:e.jsx(re,{className:"w-12 h-12 text-muted-foreground"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex gap-2",children:[e.jsx(v,{className:`${r.getStatusColor(s.status)} text-white`,children:r.getStatusText(s.status)}),s.featured&&e.jsx(v,{variant:"secondary",children:"Featured"}),s.verified&&e.jsx(v,{className:"bg-green-600 text-white",children:"Verified"})]}),s.images&&s.images.length>0&&e.jsxs("div",{className:"absolute bottom-3 left-3 bg-black/70 text-white px-2 py-1 rounded text-sm",children:[s.images.length," ",s.images.length===1?"photo":"photos"]})]}),e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-1",children:s.title}),e.jsxs("p",{className:"text-muted-foreground flex items-center mb-2",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),W(s)]}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.formatPrice(s.price,s.listingType)})]}),e.jsxs(se,{children:[e.jsx(te,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",children:e.jsx(ie,{className:"w-4 h-4"})})}),e.jsxs(ae,{align:"end",children:[e.jsx(u,{asChild:!0,children:e.jsxs(c,{to:`/vendor/properties/details/${s._id}`,children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"View Details"]})}),e.jsx(u,{asChild:!0,children:e.jsxs(c,{to:`/vendor/properties/edit/${s._id}`,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Edit Property"]})}),e.jsxs(u,{onClick:()=>C(s._id,s.featured),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),s.featured?"Unfeature":"Promote"]}),s.status==="active"&&e.jsxs(u,{onClick:()=>T(s),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),s.listingType==="sale"?"Mark as Sold":s.listingType==="rent"?"Mark as Rented":"Mark as Leased"]}),e.jsxs(u,{className:"text-red-600",onClick:()=>H(s._id),children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.bedrooms>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"}),e.jsx("p",{className:"font-semibold",children:s.bedrooms})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"}),e.jsx("p",{className:"font-semibold",children:s.bathrooms})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Area"}),e.jsx("p",{className:"font-semibold",children:r.formatArea(s.area)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"}),e.jsx("p",{className:"font-semibold capitalize",children:s.type})]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-muted-foreground mb-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),s.views," views"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"0 leads"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(k,{className:"w-4 h-4 mr-1"}),"0 favorites"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),"Listed ",q(s.createdAt)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{to:`/vendor/properties/details/${s._id}`,children:e.jsxs(i,{size:"sm",variant:"outline",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"View Details"]})}),e.jsx(c,{to:`/vendor/properties/edit/${s._id}`,children:e.jsxs(i,{size:"sm",variant:"outline",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Edit"]})}),e.jsxs(i,{size:"sm",onClick:()=>C(s._id,s.featured),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),s.featured?"Unfeature":"Promote"]}),s.status==="active"&&e.jsx(i,{size:"sm",variant:"outline",onClick:()=>T(s),children:s.listingType==="sale"?"Mark as Sold":s.listingType==="rent"?"Mark as Rented":"Mark as Leased"})]})]})]})})},s._id))}),S.length===0&&!b&&e.jsx(n,{children:e.jsxs(d,{className:"p-12 text-center",children:[e.jsx(L,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No properties found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:o||m!=="all"||x!=="all"?"No properties match your search criteria":"You haven't added any properties yet"}),e.jsx(c,{to:"/vendor/properties/add",children:e.jsxs(i,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Add Your First Property"]})})]})}),e.jsx(le,{property:I,open:B,onOpenChange:y,onUpdateStatus:Q})]})};export{Te as default};
