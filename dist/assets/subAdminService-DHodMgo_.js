const p="https://api.akodefy.com/api";class d{async makeRequest(e,t={}){const s=`${p}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},...t},o=localStorage.getItem("token");o&&(r.headers={...r.headers,Authorization:`Bearer ${o}`});try{const a=await fetch(s,r);if(!a.ok){const c=a.headers.get("content-type");let n;throw c&&c.includes("application/json")?n=await a.json().catch(()=>({success:!1,message:`HTTP ${a.status}: ${a.statusText}`})):n={success:!1,message:`HTTP ${a.status}: ${a.statusText}`},new Error(n.message||"An error occurred")}const i=a.headers.get("content-type");if(!i||!i.includes("application/json"))throw new Error("Invalid response format: Expected JSON");return await a.json()}catch(a){throw console.error("SubAdmin API request failed:",a),a}}async getDashboardStats(){try{return(await this.makeRequest("/subadmin/dashboard")).data}catch(e){throw new Error(e.message||"Failed to fetch dashboard stats")}}async getPendingProperties(e=1,t=10,s=""){try{return(await this.makeRequest(`/subadmin/properties/pending?page=${e}&limit=${t}&search=${s}`)).data}catch(r){throw new Error(r.message||"Failed to fetch pending properties")}}async approveProperty(e){try{return(await this.makeRequest(`/subadmin/properties/${e}/approve`,{method:"POST"})).data}catch(t){throw new Error(t.message||"Failed to approve property")}}async rejectProperty(e,t){try{return(await this.makeRequest(`/subadmin/properties/${e}/reject`,{method:"POST",body:JSON.stringify({reason:t})})).data}catch(s){throw new Error(s.message||"Failed to reject property")}}async getSupportTickets(e=1,t=10,s="open"){try{return(await this.makeRequest(`/subadmin/support/tickets?page=${e}&limit=${t}&status=${s}`)).data}catch(r){throw new Error(r.message||"Failed to fetch support tickets")}}async updateSupportTicket(e,t,s){try{return(await this.makeRequest(`/subadmin/support/tickets/${e}`,{method:"PATCH",body:JSON.stringify({status:t,response:s})})).data}catch(r){throw new Error(r.message||"Failed to update support ticket")}}async getVendorPerformance(){try{return(await this.makeRequest("/subadmin/vendors/performance")).data}catch(e){throw new Error(e.message||"Failed to fetch vendor performance")}}async sendNotification(e){try{await this.makeRequest("/subadmin/notifications/send",{method:"POST",body:JSON.stringify(e)})}catch(t){throw new Error(t.message||"Failed to send notification")}}async getCityReport(e,t,s){try{const r=new URLSearchParams;return t&&r.append("startDate",t),s&&r.append("endDate",s),(await this.makeRequest(`/subadmin/reports/city/${e}?${r}`)).data}catch(r){throw new Error(r.message||"Failed to fetch city report")}}async getContentReports(){try{return(await this.makeRequest("/subadmin/content/reports")).data}catch(e){throw new Error(e.message||"Failed to fetch content reports")}}async getPendingPromotions(){try{return(await this.makeRequest("/subadmin/promotions/pending")).data}catch(e){throw new Error(e.message||"Failed to fetch pending promotions")}}}const u=new d;export{u as s};
