import { useState, useEffect } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Input } from "@/components/ui/input";

import { import { 
  Heart, 
  X, 
  Share, 
  Phone, 
  MapPin, 
  Bed, 
  Bath, 
  Square,
  Search,
  Calendar,
  GitCompare,
  Filter,
  SortAsc,
  Loader2
} from "lucide-react";

import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Checkbox } from "@/components/ui/checkbox";
import { Link } from "react-router-dom";
import favoriteService, { Favorite, FavoriteStats } from "@/services/favoriteService";



const MyFavorites = () => {
  const [searchQuery, setSearchQuery] = useState("");
  const [sortBy, setSortBy] = useState("newest");
  const [filterType, setFilterType] = useState("");
  const [selectedProperties, setSelectedProperties] = useState<string[]>([]);
  const [favorites, setFavorites] = useState<Favorite[]>([]);
  const [stats, setStats] = useState<FavoriteStats | null>(null);
  const [loading, setLoading] = useState(true);
  const [currentPage, setCurrentPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);



  const fetchFavorites = async () => {
    try {
      setLoading(true);
      const filters = {
        page: currentPage,
        limit: 10,
        search: searchQuery || undefined,
        propertyType: filterType || undefined,
      };

      const [favoritesResponse, statsResponse] = await Promise.all([
        favoriteService.getFavorites(filters),
        favoriteService.getFavoriteStats(),
      ]);

      setFavorites(favoritesResponse.data.favorites);
      setTotalPages(favoritesResponse.data.pagination.totalPages);
      setStats(statsResponse.data);
    } catch (error) {
      console.error("Failed to fetch favorites:", error);
    } finally {
      setLoading(false);
    }
  };



  useEffect(() => {
    fetchFavorites();
  }, [currentPage, searchQuery, filterType]);

  const handleSearch = (value: string) => {
    setSearchQuery(value);
    setCurrentPage(1);
  };

  const handleTypeFilter = (value: string) => {
    setFilterType(value);
    setCurrentPage(1);
  };



  const removeFavorite = async (propertyId: string) => {
    try {
      await favoriteService.removeFromFavorites(propertyId);
      // Remove from local state
      setFavorites(prev => prev.filter(fav => fav.property?._id !== propertyId));
      setSelectedProperties(prev => prev.filter(id => id !== propertyId));
      // Refresh stats
      const statsResponse = await favoriteService.getFavoriteStats();
      setStats(statsResponse.data);
    } catch (error) {
      console.error("Failed to remove from favorites:", error);
    }
  };



  const toggleSelection = (propertyId: string) => {
    setSelectedProperties(prev => 
      prev.includes(propertyId) 
        ? prev.filter(id => id !== propertyId)
        : [...prev, propertyId]
    );
  };



  if (loading) {  if (loading) {

    return (    return (

      <div className="flex justify-center items-center py-12">      <div className="flex justify-center items-center py-12">

        <Loader2 className="h-8 w-8 animate-spin" />        <Loader2 className="h-8 w-8 animate-spin" />

        <span className="ml-2 text-lg">Loading favorites...</span>        <span className="ml-2 text-lg">Loading favorites...</span>

      </div>      </div>

    );    );

  }  }



  return (  return (

    <div className="space-y-6 pt-16">    <div className="space-y-6 pt-16">

      {/* Header */}      {/* Header */}

      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">

        <div>        <div>

          <h1 className="text-3xl font-bold flex items-center gap-2">          <h1 className="text-3xl font-bold flex items-center gap-2">

            <Heart className="w-8 h-8 text-red-500" />            <Heart className="w-8 h-8 text-red-500" />

            My Favorites            My Favorites

          </h1>          </h1>

          <p className="text-muted-foreground mt-1">          <p className="text-muted-foreground mt-1">

            Properties you've saved for later            Properties you've saved for later

          </p>          </p>

        </div>        </div>

                

        <div className="flex gap-2">        <div className="flex gap-2">

          <Link to="/customer/compare"           <Link to="/customer/compare" 

                className={selectedProperties.length >= 2 ? "" : "pointer-events-none opacity-50"}>                className={selectedProperties.length >= 2 ? "" : "pointer-events-none opacity-50"}>

            <Button             <Button 

              variant="outline"               variant="outline" 

              disabled={selectedProperties.length < 2}              disabled={selectedProperties.length < 2}

              className="flex items-center gap-2"              className="flex items-center gap-2"

            >            >

              <GitCompare className="w-4 h-4" />              <GitCompare className="w-4 h-4" />

              Compare ({selectedProperties.length})              Compare ({selectedProperties.length})

            </Button>            </Button>

          </Link>          </Link>

          <Button variant="outline">          <Button variant="outline">

            <Share className="w-4 h-4 mr-2" />            <Share className="w-4 h-4 mr-2" />

            Share List            Share List

          </Button>          </Button>

        </div>        </div>

      </div>      </div>



      {/* Search and Filters */}      {/* Search and Filters */}

      <Card>      <Card>

        <CardContent className="p-4">        <CardContent className="p-4">

          <div className="flex flex-col sm:flex-row gap-4">          <div className="flex flex-col sm:flex-row gap-4">

            <div className="relative flex-1">            <div className="relative flex-1">

              <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground" />              <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground" />

              <Input              <Input

                type="text"                type="text"

                placeholder="Search your favorites..."                placeholder="Search your favorites..."

                className="pl-10"                className="pl-10"

                value={searchQuery}                value={searchQuery}

                onChange={(e) => handleSearch(e.target.value)}                onChange={(e) => setSearchQuery(e.target.value)}

              />              />

            </div>            </div>

                        

            <Select value={filterType} onValueChange={handleTypeFilter}>            <Select value={filterType} onValueChange={handleTypeFilter}>

              <SelectTrigger className="w-40">              <SelectTrigger className="w-40">

                <SelectValue placeholder="Property Type" />                <SelectValue placeholder="Property Type" />

              </SelectTrigger>              </SelectTrigger>

              <SelectContent>              <SelectContent>

                <SelectItem value="">All Types</SelectItem>                <SelectItem value="">All Types</SelectItem>

                <SelectItem value="apartment">Apartment</SelectItem>                <SelectItem value="apartment">Apartment</SelectItem>

                <SelectItem value="villa">Villa</SelectItem>                <SelectItem value="villa">Villa</SelectItem>

                <SelectItem value="house">House</SelectItem>                <SelectItem value="house">House</SelectItem>

              </SelectContent>                <SelectItem value="plot">Plot</SelectItem>

            </Select>                <SelectItem value="commercial">Commercial</SelectItem>

                          </SelectContent>

            <Select value={sortBy} onValueChange={setSortBy}>            </Select>

              <SelectTrigger className="w-40">          </div>

                <SelectValue />        </CardContent>

              </SelectTrigger>      </Card>

              <SelectContent>

                <SelectItem value="newest">Newest First</SelectItem>      {/* Stats */}

                <SelectItem value="oldest">Oldest First</SelectItem>      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">

                <SelectItem value="price-high">Price: High to Low</SelectItem>        <Card>

                <SelectItem value="price-low">Price: Low to High</SelectItem>          <CardContent className="p-4">

                <SelectItem value="area">Area: Large to Small</SelectItem>            <div className="flex items-center gap-3">

              </SelectContent>              <div className="p-2 bg-red-500/10 rounded-lg">

            </Select>                <Heart className="w-5 h-5 text-red-500" />

          </div>              </div>

        </CardContent>              <div>

      </Card>                <p className="text-2xl font-bold">{stats?.totalFavorites || 0}</p>

                <p className="text-sm text-muted-foreground">Total Favorites</p>
              </div>
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardContent className="p-4">
            <div className="flex items-center gap-3">
              <div className="p-2 bg-green-500/10 rounded-lg">
                <SortAsc className="w-5 h-5 text-green-500" />
              </div>
              <div>
                <p className="text-2xl font-bold">
                  {stats?.avgPrice ? favoriteService.formatPrice(stats.avgPrice) : 'â‚¹0'}
                </p>
                <p className="text-sm text-muted-foreground">Avg Price</p>
              </div>
            </div>
          </CardContent>
        </Card>

        
        <Card>
          <CardContent className="p-4">
            <div className="flex items-center gap-3">
              <div className="p-2 bg-blue-500/10 rounded-lg">

                  <p className="text-sm text-muted-foreground">Still Available</p>                <Filter className="w-5 h-5 text-blue-500" />

                <Filter className="w-5 h-5 text-blue-500" />
              </div>
              <div>
                <p className="text-2xl font-bold">
                  {stats?.availableProperties || 0}
                </p>
                <p className="text-sm text-muted-foreground">Still Available</p>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>
    )}

    {/* Favorites List */}
    <div className="space-y-4">
      {favorites.length === 0 ? (
        <Card>
          <CardContent className="p-12 text-center">
            <Heart className="w-16 h-16 text-muted-foreground mx-auto mb-4" />
            <h3 className="text-xl font-semibold mb-2">No favorites found</h3>
            <p className="text-muted-foreground mb-4">
              {searchQuery || filterType ? 
                "No properties match your search criteria" : 

                  "Start adding properties to your favorites to see them here"
              }
            </p>
            <Link to="/customer/search">
              <Button>
                <Search className="w-4 h-4 mr-2" />
                Search Properties
              </Button>
            </Link>
          </CardContent>
        </Card>
      ) : (
        favorites.map((favorite) => {
          const property = favorite.property;
          if (!property) return null;
          
          const statusInfo = favoriteService.getPropertyStatusBadge(property);
          
          return (
            <Card key={favorite._id} className="hover:shadow-lg transition-shadow">
              <CardContent className="p-0">
                <div className="flex flex-col md:flex-row">
                  {/* Property Image */}
                  <div className="md:w-80 h-64 md:h-48 bg-muted flex items-center justify-center relative">
                    {property.images && property.images.length > 0 ? (
                      <img 
                        src={property.images[0]} 
                        alt={property.title}
                        className="w-full h-full object-cover"
                      />
                    ) : (
                      <div className="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center">
                        <MapPin className="w-6 h-6 text-primary" />
                      </div>
                    )}

                    {/* Status badges */}
                    <div className="absolute top-2 left-2 flex flex-col gap-1">
                      <Badge variant={statusInfo.variant as any}>
                        {statusInfo.label}
                      </Badge>
                    </div>

                    {/* Selection checkbox */}
                    <div className="absolute top-2 right-2">
                      <Checkbox
                        checked={selectedProperties.includes(property._id)}
                        onCheckedChange={() => toggleSelection(property._id)}
                        className="bg-white"
                      />
                    </div>
                  </div>

                  {/* Property Details */}
                  <div className="flex-1 p-6">
                    <div className="flex justify-between items-start mb-4">
                      <div>
                        <h3 className="text-xl font-semibold mb-2">{property.title}</h3>
                        <div className="flex items-center text-muted-foreground mb-2">
                          <MapPin className="w-4 h-4 mr-1" />
                          <span className="text-sm">{property.address}, {property.city}, {property.state}</span>
                        </div>

                        </div>                          <div className="flex items-center gap-4 text-sm text-muted-foreground">

                        <div className="flex items-center gap-4 text-sm text-muted-foreground">                            <div className="flex items-center gap-1">

                          <div className="flex items-center gap-1">                              <Bed className="w-4 h-4" />

                            <Bed className="w-4 h-4" />                              <span>{property.bedrooms} BHK</span>

                            <span>{favorite.property?.bedrooms} BHK</span>                            </div>

                          </div>                            <div className="flex items-center gap-1">

                          <div className="flex items-center gap-1">                              <Bath className="w-4 h-4" />

                            <Bath className="w-4 h-4" />                              <span>{property.bathrooms} Bath</span>

                            <span>{favorite.property?.bathrooms} Bath</span>                            </div>

                          </div>                            <div className="flex items-center gap-1">

                          <div className="flex items-center gap-1">                              <Square className="w-4 h-4" />

                            <Square className="w-4 h-4" />                              <span>{property.area} sq.ft</span>

                            <span>{favorite.property?.area} sq.ft</span>                            </div>

                          </div>                          </div>

                        </div>                        </div>

                      </div>                        

                                              <div className="text-right">

                      <div className="text-right">                          <div className="text-2xl font-bold text-primary">

                        <div className="text-2xl font-bold text-primary">                            {favoriteService.formatPrice(property.price)}

                          {favoriteService.formatPrice(favorite.property?.price || 0)}                          </div>

                        </div>                          <div className="text-xs text-muted-foreground mt-1">

                        <div className="text-xs text-muted-foreground mt-1">                            {favoriteService.formatPricePerSqFt(property.price, property.area)} per sq.ft

                          {favorite.property?.area &&                           </div>

                            favoriteService.formatPricePerSqFt(                        </div>

                              favorite.property.price,                       </div>

                              favorite.property.area

                            ) + " per sq.ft"                      {/* Amenities */}

                          }                      <div className="flex flex-wrap gap-1 mb-4">

                        </div>                        {property.amenities && property.amenities.slice(0, 3).map((amenity, idx) => (

                      </div>                          <Badge key={idx} variant="outline" className="text-xs">

                    </div>                            {amenity}

                          </Badge>

                    {/* Amenities */}                        ))}

                    <div className="flex flex-wrap gap-1 mb-4">                        {property.amenities && property.amenities.length > 3 && (

                      {favorite.property?.amenities?.slice(0, 3).map((amenity, index) => (                          <Badge variant="outline" className="text-xs">

                        <Badge key={index} variant="outline" className="text-xs">                            +{property.amenities.length - 3} more

                          {amenity}                          </Badge>

                        </Badge>                        )}

                      ))}                      </div>

                      {(favorite.property?.amenities?.length || 0) > 3 && (

                        <Badge variant="outline" className="text-xs">                      {/* Meta Info */}

                          +{(favorite.property?.amenities?.length || 0) - 3} more                      <div className="flex items-center gap-4 text-xs text-muted-foreground mb-4">

                        </Badge>                        <div className="flex items-center gap-1">

                      )}                          <Calendar className="w-3 h-3" />

                    </div>                          <span>Added {favoriteService.getTimeAgo(favorite.createdAt)}</span>

                        </div>

                    {/* Meta Info */}                        <div className="flex items-center gap-1">

                    <div className="flex items-center gap-4 text-xs text-muted-foreground mb-4">                          <span>Owner: {property.owner?.name || 'N/A'}</span>

                      <div className="flex items-center gap-1">                        </div>

                        <Calendar className="w-3 h-3" />                      </div>

                        <span>Added {favoriteService.formatDate(favorite.createdAt)}</span>

                      </div>                      {/* Actions */}

                      <div className="flex items-center gap-1">                      <div className="flex justify-between items-center">

                        <span>Owner: {favorite.property?.owner?.name || "N/A"}</span>                        <div className="flex gap-2">

                      </div>                          <Button size="sm" variant="destructive" onClick={() => removeFavorite(property._id)}>

                    </div>                            <X className="w-4 h-4 mr-1" />

                            Remove

                    {/* Actions */}                          </Button>

                    <div className="flex justify-between items-center">                          <Button size="sm" variant="outline">

                      <div className="flex gap-2">                            <Share className="w-4 h-4" />

                        <Button                           </Button>

                          size="sm"                         </div>

                          variant="destructive"                         

                          onClick={() => removeFavorite(favorite.property?._id || "")}                        <div className="flex gap-2">

                        >                          <Button size="sm" variant="outline" disabled={!property.isAvailable}>

                          <X className="w-4 h-4 mr-1" />                            <Phone className="w-4 h-4 mr-1" />

                          Remove                            Contact Owner

                        </Button>                          </Button>

                        <Button size="sm" variant="outline">                          <Link to={`/property/${property._id}`}>

                          <Share className="w-4 h-4" />                            <Button size="sm" disabled={!property.isAvailable}>

                        </Button>                              View Details

                      </div>                            </Button>

                                                </Link>

                      <div className="flex gap-2">                        </div>

                        <Button                       </div>

                          size="sm"                     </div>

                          variant="outline"                   </div>

                          disabled={!favorite.property?.isAvailable}                </CardContent>

                        >              </Card>

                          <Phone className="w-4 h-4 mr-1" />            );

                          Contact Owner          })

                        </Button>        )}

                        <Button size="sm" disabled={!favorite.property?.isAvailable}>      </div>            <Select value={sortBy} onValueChange={setSortBy}>

                          View Details              <SelectTrigger className="w-40">

                        </Button>                <SelectValue />

                      </div>              </SelectTrigger>

                    </div>              <SelectContent>

                  </div>                <SelectItem value="newest">Newest First</SelectItem>

                </div>                <SelectItem value="oldest">Oldest First</SelectItem>

              </CardContent>                <SelectItem value="price-high">Price: High to Low</SelectItem>

            </Card>                <SelectItem value="price-low">Price: Low to High</SelectItem>

          ))                <SelectItem value="area">Area: Large to Small</SelectItem>

        )}              </SelectContent>

      </div>            </Select>

          </div>

      {/* Quick Actions Footer */}        </CardContent>

      {selectedProperties.length > 0 && (      </Card>

        <Card className="fixed bottom-4 right-4 w-auto z-50">

          <CardContent className="p-4">      {/* Stats */}

            <div className="flex items-center gap-3">      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">

              <span className="text-sm font-medium">        <Card>

                {selectedProperties.length} selected          <CardContent className="p-4">

              </span>            <div className="flex items-center gap-3">

              <Button size="sm" variant="outline" onClick={() => setSelectedProperties([])}>              <div className="p-2 bg-red-500/10 rounded-lg">

                Clear                <Heart className="w-5 h-5 text-red-500" />

              </Button>              </div>

              <Link to="/customer/compare">              <div>

                <Button size="sm" disabled={selectedProperties.length < 2}>                <p className="text-2xl font-bold">{favorites.length}</p>

                  <GitCompare className="w-4 h-4 mr-1" />                <p className="text-sm text-muted-foreground">Total Favorites</p>

                  Compare              </div>

                </Button>            </div>

              </Link>          </CardContent>

            </div>        </Card>

          </CardContent>        

        </Card>        <Card>

      )}          <CardContent className="p-4">

    </div>            <div className="flex items-center gap-3">

  );              <div className="p-2 bg-green-500/10 rounded-lg">

};                <SortAsc className="w-5 h-5 text-green-500" />

              </div>

export default MyFavorites;              <div>
                <p className="text-2xl font-bold">
                  {favorites.filter(f => f.priceDropped).length}
                </p>
                <p className="text-sm text-muted-foreground">Price Drops</p>
              </div>
            </div>
          </CardContent>
        </Card>
        
        <Card>
          <CardContent className="p-4">
            <div className="flex items-center gap-3">
              <div className="p-2 bg-blue-500/10 rounded-lg">
                <Filter className="w-5 h-5 text-blue-500" />
              </div>
              <div>
                <p className="text-2xl font-bold">
                  {favorites.filter(f => f.status === "available").length}
                </p>
                <p className="text-sm text-muted-foreground">Still Available</p>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>

      {/* Favorites List */}
      <div className="space-y-4">
        {filteredFavorites.length === 0 ? (
          <Card>
            <CardContent className="p-12 text-center">
              <Heart className="w-16 h-16 text-muted-foreground mx-auto mb-4" />
              <h3 className="text-xl font-semibold mb-2">No favorites found</h3>
              <p className="text-muted-foreground mb-4">
                {searchQuery || filterType ? 
                  "No properties match your search criteria" : 
                  "Start adding properties to your favorites to see them here"
                }
              </p>
              <Link to="/customer/search">
                <Button>
                  <Search className="w-4 h-4 mr-2" />
                  Search Properties
                </Button>
              </Link>
            </CardContent>
          </Card>
        ) : (
          filteredFavorites.map((property) => (
            <Card key={property.id} className="hover:shadow-lg transition-shadow">
              <CardContent className="p-0">
                <div className="flex flex-col md:flex-row">
                  {/* Property Image */}
                  <div className="md:w-80 h-64 md:h-48 bg-muted flex items-center justify-center relative">
                    <div className="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center">
                      <MapPin className="w-6 h-6 text-primary" />
                    </div>
                    
                    {/* Status badges */}
                    <div className="absolute top-2 left-2 flex flex-col gap-1">
                      {property.priceDropped && (
                        <Badge className="bg-green-500 hover:bg-green-600">
                          Price Drop!
                        </Badge>
                      )}
                      {property.status === "sold" && (
                        <Badge variant="destructive">Sold</Badge>
                      )}
                    </div>

                    {/* Selection checkbox */}
                    <div className="absolute top-2 right-2">
                      <Checkbox
                        checked={selectedProperties.includes(property.id)}
                        onCheckedChange={() => toggleSelection(property.id)}
                        className="bg-white"
                      />
                    </div>
                  </div>

                  {/* Property Details */}
                  <div className="flex-1 p-6">
                    <div className="flex justify-between items-start mb-4">
                      <div>
                        <h3 className="text-xl font-semibold mb-2">{property.title}</h3>
                        <div className="flex items-center text-muted-foreground mb-2">
                          <MapPin className="w-4 h-4 mr-1" />
                          <span className="text-sm">{property.location}</span>
                        </div>
                        <div className="flex items-center gap-4 text-sm text-muted-foreground">
                          <div className="flex items-center gap-1">
                            <Bed className="w-4 h-4" />
                            <span>{property.bedrooms} BHK</span>
                          </div>
                          <div className="flex items-center gap-1">
                            <Bath className="w-4 h-4" />
                            <span>{property.bathrooms} Bath</span>
                          </div>
                          <div className="flex items-center gap-1">
                            <Square className="w-4 h-4" />
                            <span>{property.area} sq.ft</span>
                          </div>
                        </div>
                      </div>
                      
                      <div className="text-right">
                        <div className="text-2xl font-bold text-primary">
                          {property.priceDropped && property.newPrice ? 
                            formatPrice(property.newPrice) : 
                            formatPrice(property.price)
                          }
                        </div>
                        {property.priceDropped && property.newPrice && (
                          <div className="text-sm text-muted-foreground line-through">
                            {formatPrice(property.price)}
                          </div>
                        )}
                        <div className="text-xs text-muted-foreground mt-1">
                          {formatPrice(Math.round((property.newPrice || property.price) / property.area))} per sq.ft
                        </div>
                      </div>
                    </div>

                    {/* Amenities */}
                    <div className="flex flex-wrap gap-1 mb-4">
                      {property.amenities.slice(0, 3).map((amenity) => (
                        <Badge key={amenity} variant="outline" className="text-xs">
                          {amenity}
                        </Badge>
                      ))}
                      {property.amenities.length > 3 && (
                        <Badge variant="outline" className="text-xs">
                          +{property.amenities.length - 3} more
                        </Badge>
                      )}
                    </div>

                    {/* Meta Info */}
                    <div className="flex items-center gap-4 text-xs text-muted-foreground mb-4">
                      <div className="flex items-center gap-1">
                        <Calendar className="w-3 h-3" />
                        <span>Added {formatDate(property.addedDate)}</span>
                      </div>
                      <div className="flex items-center gap-1">
                        <span>Agent: {property.agent.name}</span>
                        {property.agent.verified && (
                          <Badge variant="secondary" className="text-xs">Verified</Badge>
                        )}
                      </div>
                    </div>

                    {/* Actions */}
                    <div className="flex justify-between items-center">
                      <div className="flex gap-2">
                        <Button size="sm" variant="destructive" onClick={() => removeFavorite(property.id)}>
                          <X className="w-4 h-4 mr-1" />
                          Remove
                        </Button>
                        <Button size="sm" variant="outline">
                          <Share className="w-4 h-4" />
                        </Button>
                      </div>
                      
                      <div className="flex gap-2">
                        <Button size="sm" variant="outline" disabled={property.status === "sold"}>
                          <Phone className="w-4 h-4 mr-1" />
                          Contact Agent
                        </Button>
                        <Button size="sm" disabled={property.status === "sold"}>
                          View Details
                        </Button>
                      </div>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          ))
        )}
      </div>

      {/* Quick Actions Footer */}
      {selectedProperties.length > 0 && (
        <Card className="fixed bottom-4 right-4 w-auto z-50">
          <CardContent className="p-4">
            <div className="flex items-center gap-3">
              <span className="text-sm font-medium">
                {selectedProperties.length} selected
              </span>
              <Button size="sm" variant="outline" onClick={() => setSelectedProperties([])}>
                Clear
              </Button>
              <Link to="/customer/compare">
                <Button size="sm" disabled={selectedProperties.length < 2}>
                  <GitCompare className="w-4 h-4 mr-1" />
                  Compare
                </Button>
              </Link>
            </div>
          </CardContent>
        </Card>
      )}
    </div>
  );
};

export default MyFavorites;